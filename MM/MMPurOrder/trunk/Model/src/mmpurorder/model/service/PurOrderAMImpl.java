package mmpurorder.model.service;

import appCostCenterSevice.model.service.AppCostCenterServiceAMImpl;

import java.math.BigDecimal;

import java.sql.CallableStatement;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Types;

import java.util.ArrayList;

import javax.el.ELContext;
import javax.el.ExpressionFactory;
import javax.el.ValueExpression;

import javax.faces.application.Application;
import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

import mmpurorder.model.service.common.PurOrderAM;
import mmpurorder.model.views.DlvSchdlBalanceViewImpl;
import mmpurorder.model.views.LovCoaIdImpl;
import mmpurorder.model.views.LovItmIdImpl;
import mmpurorder.model.views.LovItmIdNewVOImpl;
import mmpurorder.model.views.LovRefPoDocIdImpl;
import mmpurorder.model.views.LovUomVwVOImpl;
import mmpurorder.model.views.MmDrftPoDlvSchdlVOImpl;
import mmpurorder.model.views.MmDrftPoFlxVOImpl;
import mmpurorder.model.views.MmDrftPoFlxVORowImpl;
import mmpurorder.model.views.MmDrftPoItmVOImpl;
import mmpurorder.model.views.MmDrftPoOcVOImpl;
import mmpurorder.model.views.MmDrftPoTncVOImpl;
import mmpurorder.model.views.MmDrftPoTrLinesVOImpl;
import mmpurorder.model.views.MmDrftPoTrVOImpl;
import mmpurorder.model.views.MmDrftPoVOImpl;
import mmpurorder.model.views.MmPendOrdVwVOImpl;
import mmpurorder.model.views.MmQuotFlxVOImpl;
import mmpurorder.model.views.PoSearchVOImpl;

import oracle.adf.share.logging.ADFLogger;

import oracle.jbo.ApplicationModule;
import oracle.jbo.AttributeDef;
import oracle.jbo.JboException;
import oracle.jbo.Row;
import oracle.jbo.RowSetIterator;
import oracle.jbo.ViewCriteria;
import oracle.jbo.ViewObject;
import oracle.jbo.client.Configuration;
import oracle.jbo.domain.Date;
import oracle.jbo.domain.Number;
import oracle.jbo.server.ApplicationModuleImpl;
import oracle.jbo.server.RowQualifier;
import oracle.jbo.server.ViewLinkImpl;
import oracle.jbo.server.ViewObjectImpl;

import org.apache.myfaces.trinidad.context.RequestContext;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Fri Nov 30 12:42:02 IST 2012
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class PurOrderAMImpl extends ApplicationModuleImpl implements PurOrderAM {

    private static int INTEGER = Types.NUMERIC;
    private static int DATE = Types.DATE;
    private static int STRING = Types.VARCHAR;
    private static int NUMBER = Types.NUMERIC;
    private static ADFLogger _log = (ADFLogger) ADFLogger.createADFLogger(PurOrderAMImpl.class);
    Number zero = new Number(0);

    /**
     * This is the default constructor (do not remove).
     */
    public PurOrderAMImpl() {
    }

    /**
     *Global round digit for Amount
     * @return
     */

    public Integer getGlblRoundAmtDigit() {
        if (resolvEl("#{pageFlowScope.GLBL_AMT_DIGIT1}") != null) {
            return Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_AMT_DIGIT1}"));
        } else {
            return 6;
        }
    }

    /**
     *Global round digit for Quantity
     * @return
     */

    public Integer getGlblRoundQtyDigit() {
        if (resolvEl("#{pageFlowScope.GLBL_QTY_DIGIT1}") != null) {
            return Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_QTY_DIGIT1}"));
        } else {
            return 6;
        }

    }

    /**
     *Global round digit for currency rate
     * @return
     */

    public Integer getGlblRoundCurrRateDigit() {
        if (resolvEl("#{pageFlowScope.GLBL_CURR_DIGIT1}") != null) {
            return Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_CURR_DIGIT1}"));
        } else {
            return 6;
        }

    }


    /**
     * Container's getter for MmDrftPo.
     * @return MmDrftPo
     */
    public MmDrftPoVOImpl getMmDrftPo() {
        return (MmDrftPoVOImpl) findViewObject("MmDrftPo");
    }

    /**
     * Container's getter for MmDrftPoDlvSchdl.
     * @return MmDrftPoDlvSchdl
     */
    public ViewObjectImpl getMmDrftPoDlvSchdl() {
        return (ViewObjectImpl) findViewObject("MmDrftPoDlvSchdl");
    }

    /**
     * Container's getter for MmDrftPoItm.
     * @return MmDrftPoItm
     */
    public ViewObjectImpl getMmDrftPoItm() {
        return (ViewObjectImpl) findViewObject("MmDrftPoItm");
    }

    /**
     * Container's getter for MmDrftPoOc.
     * @return MmDrftPoOc
     */
    public MmDrftPoOcVOImpl getMmDrftPoOc() {
        return (MmDrftPoOcVOImpl) findViewObject("MmDrftPoOc");
    }

    /**
     * Container's getter for MmDrftPoPmtSchdl.
     * @return MmDrftPoPmtSchdl
     */
    public ViewObjectImpl getMmDrftPoPmtSchdl() {
        return (ViewObjectImpl) findViewObject("MmDrftPoPmtSchdl");
    }

    /**
     * Container's getter for MmDrftPoTnc.
     * @return MmDrftPoTnc
     */
    public ViewObjectImpl getMmDrftPoTnc() {
        return (ViewObjectImpl) findViewObject("MmDrftPoTnc");
    }

    /**
     * Container's getter for MmDrftPoTr.
     * @return MmDrftPoTr
     */
    public ViewObjectImpl getMmDrftPoTr() {
        return (ViewObjectImpl) findViewObject("MmDrftPoTr");
    }

    /**
     * Container's getter for MmDrftPoTrLines.
     * @return MmDrftPoTrLines
     */
    public ViewObjectImpl getMmDrftPoTrLines() {
        return (ViewObjectImpl) findViewObject("MmDrftPoTrLines");
    }

    /**
     * Container's getter for PoSearch.
     * @return PoSearch
     */
    public PoSearchVOImpl getPoSearch() {
        return (PoSearchVOImpl) findViewObject("PoSearch");
    }

    /**
     * Container's getter for LovEoId.
     * @return LovEoId
     */
    public ViewObjectImpl getLovEoId() {

        return (ViewObjectImpl) findViewObject("LovEoId");
    }

    /**
     * Container's getter for LovOrgId.
     * @return LovOrgId
     */
    public ViewObjectImpl getLovOrgId() {
        return (ViewObjectImpl) findViewObject("LovOrgId");
    }

    /**
     * Container's getter for DrftPoToDrftPoDlvSchdlVL1.
     * @return DrftPoToDrftPoDlvSchdlVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoDlvSchdlVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoDlvSchdlVL1");
    }

    /**
     * Container's getter for DrftPoToDrftPoItmVL1.
     * @return DrftPoToDrftPoItmVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoItmVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoItmVL1");
    }

    /**
     * Container's getter for DrftPoToDrftPoOcVL1.
     * @return DrftPoToDrftPoOcVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoOcVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoOcVL1");
    }

    /**
     * Container's getter for DrftPoToDrftPoPmtSchdlVL1.
     * @return DrftPoToDrftPoPmtSchdlVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoPmtSchdlVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoPmtSchdlVL1");
    }

    /**
     * Container's getter for DrftPoToDrftPoTncVL1.
     * @return DrftPoToDrftPoTncVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoTncVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoTncVL1");
    }

    /**
     * Container's getter for DrftPoToDrftPoTrVL1.
     * @return DrftPoToDrftPoTrVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoTrVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoTrVL1");
    }

    /**
     * Container's getter for DrftPoTrToDrftPoTrLinesVL1.
     * @return DrftPoTrToDrftPoTrLinesVL1
     */
    public ViewLinkImpl getDrftPoTrToDrftPoTrLinesVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoTrToDrftPoTrLinesVL1");
    }

    /**
     * Container's getter for LovCurrId.
     * @return LovCurrId
     */
    public ViewObjectImpl getLovCurrId() {
        return (ViewObjectImpl) findViewObject("LovCurrId");
    }

    public void searchQuery(Integer SlocId, String OrgId, String DocId, String CldId) {
        ViewObject v1 = this.getMmDrftPo();
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        v1.setWhereClause("SLOC_ID=" + SlocId + " AND ORG_ID='" + orgId + "' AND DOC_ID='" + DocId + "' and CLD_ID='" +
                          CldId + "'");
        v1.executeQuery();
        System.out.println("Rows remainings=" + v1.getEstimatedRowCount());
        Row[] rr1 = this.getMmDrftPo().getFilteredRows("DocId", DocId);
        if (DocId != null && rr1.length > 0) {
            _log.info("docID is and type1 " + DocId + "  " + rr1[0].getAttribute("PoType"));
            // if (this.getMmDrftPo().getCurrentRow() != null) {
            _log.info("docID is and type2 " + DocId + "  " + rr1[0].getAttribute("PoType"));
            ViewObjectImpl rmrksvo = this.getAppRmrks();
            rmrksvo.setNamedWhereClauseParam("CldIdBind", CldId);
            rmrksvo.setNamedWhereClauseParam("SlocIdBind", SlocId);
            rmrksvo.setNamedWhereClauseParam("OrgIdBind", OrgId);
            rmrksvo.setNamedWhereClauseParam("DocIdBind", 18504);
            rmrksvo.setNamedWhereClauseParam("TxnDocIdBind", DocId);
            rmrksvo.setNamedWhereClauseParam("DocTypeId", rr1[0].getAttribute("PoType"));
            rmrksvo.executeQuery();

            _log.info("docID is and type3 " + DocId + "  " + rr1[0].getAttribute("PoType"));
            ViewObjectImpl atch = this.getAppWfAtchO();
            atch.setNamedWhereClauseParam("bindCldId", CldId);
            atch.setNamedWhereClauseParam("bindSlocId", SlocId);
            atch.setNamedWhereClauseParam("bindOrgId", OrgId);
            atch.setNamedWhereClauseParam("bindDocTxnId", DocId);
            atch.setNamedWhereClauseParam("bindDocId", 18504);
            atch.setNamedWhereClauseParam("bindDocTypeId", null);
            atch.executeQuery();
            // }

        }
        /*  if(v1.getEstimatedRowCount()>0)
          {
             Row[] allRows= v1.getAllRowsInRange();
            // allRows[0].getKey();
             System.out.println("No. of rows in range="+allRows.length);
             v1.setCurrentRow(allRows[0]);
              } */

    }

    public void filterFileDescription() {

        ViewObjectImpl v1 = this.getMmDrftPo();
        Row rr1 = v1.getCurrentRow();

        if (rr1 != null) {
            _log.info("docID is and type1 " + rr1.getAttribute("DocId"));
            _log.info("docID is and type2  " + rr1.getAttribute("PoType"));
            ViewObjectImpl rmrksvo = this.getAppRmrks();
            rmrksvo.setNamedWhereClauseParam("CldIdBind", rr1.getAttribute("CldId"));
            rmrksvo.setNamedWhereClauseParam("SlocIdBind", rr1.getAttribute("SlocId"));
            rmrksvo.setNamedWhereClauseParam("OrgIdBind", rr1.getAttribute("OrgId"));
            rmrksvo.setNamedWhereClauseParam("DocIdBind", 18504);
            rmrksvo.setNamedWhereClauseParam("TxnDocIdBind", rr1.getAttribute("DocId"));
            rmrksvo.setNamedWhereClauseParam("DocTypeId", rr1.getAttribute("PoType"));
            rmrksvo.executeQuery();

            _log.info("docID is and type3 " + rr1.getAttribute("DocId"));
            ViewObjectImpl atch = this.getAppWfAtchO();
            atch.setNamedWhereClauseParam("bindCldId", rr1.getAttribute("CldId"));
            atch.setNamedWhereClauseParam("bindSlocId", rr1.getAttribute("SlocId"));
            atch.setNamedWhereClauseParam("bindOrgId", rr1.getAttribute("OrgId"));
            atch.setNamedWhereClauseParam("bindDocTxnId", rr1.getAttribute("DocId"));
            atch.setNamedWhereClauseParam("bindDocId", 18504);
            atch.setNamedWhereClauseParam("bindDocTypeId", null);
            atch.executeQuery();
            // }

        }


    }


    public void resetQuery() {
        ViewObject v1 = this.getMmDrftPo();
        v1.setWhereClause(null);
        v1.executeQuery();

    }

    /**
     * Container's getter for LovItmId.
     * @return LovItmId
     */
    public LovItmIdImpl getLovItmId() {
        return (LovItmIdImpl) findViewObject("LovItmId");
    }

    /**
     * Container's getter for LovPoType.
     * @return LovPoType
     */
    public ViewObjectImpl getLovPoType() {
        return (ViewObjectImpl) findViewObject("LovPoType");
    }

    /**
     * Container's getter for LovCoaId.
     * @return LovCoaId
     */
    public ViewObjectImpl getLovCoaId() {
        return (ViewObjectImpl) findViewObject("LovCoaId");
    }

    /**
     * Container's getter for DlvSchdlBalanceView.
     * @return DlvSchdlBalanceView
     */
    public ViewObjectImpl getDlvSchdlBalanceView() {
        return (ViewObjectImpl) findViewObject("DlvSchdlBalanceView");
    }

    /**
     * Container's getter for DrftPoToDrftPoDlvSchdlBalanceVwVL1.
     * @return DrftPoToDrftPoDlvSchdlBalanceVwVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoDlvSchdlBalanceVwVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoDlvSchdlBalanceVwVL1");
    }

    /**
     * Container's getter for LovWhIdAddr.
     * @return LovWhIdAddr
     */
    public ViewObjectImpl getLovWhIdAddr() {
        return (ViewObjectImpl) findViewObject("LovWhIdAddr");
    }

    /**
     * Container's getter for LovWhId.
     * @return LovWhId
     */
    public ViewObjectImpl getLovWhId() {
        return (ViewObjectImpl) findViewObject("LovWhId");
    }

    /**
     * Container's getter for LovPoSource.
     * @return LovPoSource
     */
    public ViewObjectImpl getLovPoSource() {
        return (ViewObjectImpl) findViewObject("LovPoSource");
    }

    /**
     * Container's getter for LovSuggestSupplier.
     * @return LovSuggestSupplier
     */
    public ViewObjectImpl getLovSuggestSupplier() {
        return (ViewObjectImpl) findViewObject("LovSuggestSupplier");
    }

    /**
     * Container's getter for MmPendOrdVw.
     * @return MmPendOrdVw
     */
    public ViewObjectImpl getMmPendOrdVw() {
        return (ViewObjectImpl) findViewObject("MmPendOrdVw");
    }

    /**
     * Container's getter for DrftPoItmToPendOrdVwVL1.
     * @return DrftPoItmToPendOrdVwVL1
     */
    public ViewLinkImpl getDrftPoItmToPendOrdVwVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoItmToPendOrdVwVL1");
    }

    /**
     * Container's getter for LovSuppAddress.
     * @return LovSuppAddress
     */
    public ViewObjectImpl getLovSuppAddress() {
        return (ViewObjectImpl) findViewObject("LovSuppAddress");
    }

    /**
     * Container's getter for LovItmUom.
     * @return LovItmUom
     */
    public ViewObjectImpl getLovItmUom() {
        return (ViewObjectImpl) findViewObject("LovItmUom");
    }

    /**
     * Container's getter for MmTmpPoSuggSupp.
     * @return MmTmpPoSuggSupp
     */
    public ViewObjectImpl getMmTmpPoSuggSupp() {
        return (ViewObjectImpl) findViewObject("MmTmpPoSuggSupp");
    }

    /**
     * Container's getter for LovItmIdEo.
     * @return LovItmIdEo
     */
    public ViewObjectImpl getLovItmIdEo() {
        return (ViewObjectImpl) findViewObject("LovItmIdEo");
    }

    /**
     * Container's getter for MmTmpPoSuggSupp1.
     * @return MmTmpPoSuggSupp1
     */
    public ViewObjectImpl getMmTmpPoSuggSupp1() {
        return (ViewObjectImpl) findViewObject("MmTmpPoSuggSupp1");
    }

    /**
     * Container's getter for MmTmpPoSuggSupp2.
     * @return MmTmpPoSuggSupp2
     */
    public ViewObjectImpl getMmTmpPoSuggSupp2() {
        return (ViewObjectImpl) findViewObject("MmTmpPoSuggSupp2");
    }

    /**
     * Container's getter for MMDrftPoToSuggSuppVoVL1.
     * @return MMDrftPoToSuggSuppVoVL1
     */
    public ViewLinkImpl getMMDrftPoToSuggSuppVoVL1() {
        return (ViewLinkImpl) findViewLink("MMDrftPoToSuggSuppVoVL1");
    }

    /**
     * Container's getter for LovQuotDocId.
     * @return LovQuotDocId
     */
    public ViewObjectImpl getLovQuotDocId() {
        return (ViewObjectImpl) findViewObject("LovQuotDocId");
    }

    /**
     * Container's getter for LovRefPoDocId.
     * @return LovRefPoDocId
     */
    public LovRefPoDocIdImpl getLovRefPoDocId() {
        return (LovRefPoDocIdImpl) findViewObject("LovRefPoDocId");
    }

    /**
     * Container's getter for LovTmpltPoId.
     * @return LovTmpltPoId
     */
    public ViewObjectImpl getLovTmpltPoId() {
        return (ViewObjectImpl) findViewObject("LovTmpltPoId");
    }

    /**
     * Container's getter for LovTncId.
     * @return LovTncId
     */
    public ViewObjectImpl getLovTncId() {
        return (ViewObjectImpl) findViewObject("LovTncId");
    }

    public void saveAsPO() {

        ViewObjectImpl drftPo = getMmDrftPo();
        ViewObjectImpl poPayDlv = this.getMmDrftPoPmtSchdl();
        Row drftpoRw = drftPo.getCurrentRow();
        String docId = drftpoRw.getAttribute("DocId").toString();
        String whid = null;
        Integer fyid = Integer.parseInt(drftpoRw.getAttribute("FyId").toString());
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        Integer userId = Integer.parseInt(drftpoRw.getAttribute("UsrIdCreate").toString());

        if (drftpoRw.getAttribute("PoBasis").equals(175)) { // Rate contract
            String auth = null;
            RowQualifier rq = new RowQualifier(this.getMmDrftPo1());
            rq.setWhereClause("CldId='" + cld_id + "' and SlocId=" + slocId + " and OrgId='" + orgId + "' and DocId='" +
                              drftpoRw.getAttribute("RefPoDocId") + "'");
            Row[] r = this.getMmDrftPo1().getFilteredRows(rq);
            if (r.length > 0)
                auth = (String) r[0].getAttribute("AuthPoNo");
            drftpoRw.setAttribute("AuthPoNo", auth);
        } else if (drftpoRw.getAttribute("PoBasis").equals(490)) { // Open purchase order

            String auth = null;
            RowQualifier rq = new RowQualifier(this.getMmDrftPo1());
            rq.setWhereClause("CldId='" + cld_id + "' and SlocId=" + slocId + " and OrgId='" + orgId + "' and DocId='" +
                              drftpoRw.getAttribute("RefPoDocId") + "'");
            Row[] r = this.getMmDrftPo1().getFilteredRows(rq);
            if (r.length > 0)
                auth = (String) r[0].getAttribute("AuthPoNo");
            drftpoRw.setAttribute("AuthPoNo", auth);
            System.out.println("cld_id   " + cld_id + " open doc id" + drftpoRw.getAttribute("RefPoDocId"));
            BigDecimal retval = (BigDecimal) (callStoredFunction(NUMBER, "MM.MM_GET_OPEN_ORD_VAL(?,?,?,?,?)", new Object[] {
                                                                 cld_id, slocId, orgId,
                                                                 drftpoRw.getAttribute("RefPoDocId"), docId
            }));
            Number val = new Number(0);
            if (retval != null)
                try {
                    val = new Number(retval);
                } catch (SQLException e) {
                    System.out.println("error in cast=" + e);
                }
            if (val.compareTo(new Number(0)) == 0)
                r[0].setAttribute("PoStatus", 218);
        }
        if (drftpoRw.getAttribute("AuthPoNo") !=
            null) { // if auto po no  generated.
            StringBuilder saveMsg =
                new StringBuilder("<html><body><p><b>Purchase Order successfully Translated with PO Id - " +
                                  drftpoRw.getAttribute("AuthPoNo") + ".</b></p>");
            saveMsg.append("</body></html>");
            FacesMessage msg = new FacesMessage(saveMsg.toString());
            msg.setSeverity(FacesMessage.SEVERITY_INFO);
            FacesContext.getCurrentInstance().addMessage(null, msg);
        } else { // auto po not generated
            String poId = null;
            if (drftpoRw.getAttribute("PoType").equals(741)) { // if PO type Import purchase order
                poId = (String) (callStoredFunction(Types.VARCHAR, "MM.fn_mm_gen_id(?,?,?,?,?,?,?,?)", new Object[] {
                                                    slocId, cld_id, orgId, "MM$PO$IMP", whid, fyid,18504, Integer.parseInt(drftpoRw.getAttribute("PoType").toString())
                }));
            } else if (drftpoRw.getAttribute("PoType").equals(881)) { // if PO type Import purchase order
                poId = (String) (callStoredFunction(Types.VARCHAR, "MM.fn_mm_gen_id(?,?,?,?,?,?,?,?)", new Object[] {
                                                    slocId, cld_id, orgId, "MM$PO$CPO", whid, fyid,18504,Integer.parseInt(drftpoRw.getAttribute("PoType").toString())
                }));
            }

            else { // other than import purchase order

                poId = (String) (callStoredFunction(Types.VARCHAR, "MM.fn_mm_gen_id(?,?,?,?,?,?,?,?)", new Object[] {
                                                    slocId, cld_id, orgId, "MM$PO", whid, fyid,18504,Integer.parseInt(drftpoRw.getAttribute("PoType").toString())
                }));

            }
            if (poId != null) {

                drftpoRw.setAttribute("AuthPoNo", poId);
            }
            System.out.println("In save PO---" + poId);
            StringBuilder saveMsg =
                new StringBuilder("<html><body><p><b>Draft Purchase Order successfully translated to Purchase Order with PO Id - " +
                                  poId + "</b></p>");
            saveMsg.append("</body></html>");
            FacesMessage msg = new FacesMessage(saveMsg.toString());
            msg.setSeverity(FacesMessage.SEVERITY_INFO);
            FacesContext.getCurrentInstance().addMessage(null, msg);
        }
        drftpoRw.setAttribute("PoMode", new Integer(231));
        this.getDBTransaction().commit();
        System.out.println("Data commited");
        if (drftpoRw.getAttribute("PoType").equals(173)) {
        } else {
            Object obj = callStoredFunction(NUMBER, "MM.MM_UPDT_ORD_STK(?,?,?,?,?)", new Object[] {
                                            cld_id, slocId, orgId, fyid, docId
            });
            System.out.println("Updated stock=" + obj);
        }
        try {
            this.sendDateFromTempCcToSlsSoCc();
        } catch (Exception e) {
            e.printStackTrace();
        }

        String authPoNo = null;
        Number advncAmt = new Number(0);
        String advnFlg = "Y";
        String currNotation = "INR";
        // Alert Title – Advance payment alert

        // Alert Text – Advance payment to be made against Purchase Order No. <PO NO> dated <PO date> to <Supplier Name> for amount <currency notation> <PO amount> on <dates>
        if (drftpoRw.getAttribute("AuthPoNo") != null) {
            authPoNo = drftpoRw.getAttribute("AuthPoNo").toString();

        }


        //        FUNCTION FN_INS_IR(
        //            PARAM_CLD_ID      VARCHAR2,
        //            PARAM_INST_ID     NUMBER DEFAULT 1,
        //            PARAM_SLOC_ID     NUMBER,
        //            PARAM_HO_ORG_ID   VARCHAR2,
        //            PARAM_ORG_ID      VARCHAR2,
        //            PARAM_DOC_ID      VARCHAR2,
        //            PARAM_GLBL_DOC_ID NUMBER,
        //            PARAM_PROJ_ID     VARCHAR2 DEFAULT 'PROJ0000',
        //            PARAM_EO_ID       NUMBER,
        //            PARAM_CURR_ID     NUMBER,
        //            PARAM_CURR_RATE   NUMBER,
        //            PARAM_UID         NUMBER,
        //            PARAM_USR_DT      DATE)
        //          RETURN VARCHAR2

        try {
            if (docId != null) {
                RowQualifier rqPmt = new RowQualifier(poPayDlv);
                rqPmt.setWhereClause("CldId ='" + cld_id + "' and SlocId =" + slocId + " and  OrgId ='" + orgId +
                                     "' and DocId ='" + docId + "' and  AdvFlg ='" + advnFlg + "' ");
                Row[] rr = poPayDlv.getFilteredRows(rqPmt);
                _log.info(rr.length + " payment value " + rqPmt.getExprStr());


                if (rr.length > 0) {
                    if (drftpoRw.getAttribute("TransCurrencyDesc") != null) {
                        currNotation = drftpoRw.getAttribute("TransCurrencyDesc").toString();
                    }
                    StringBuffer alrtText = new StringBuffer();
                    alrtText.append("Advance payment to be made against Purchase Order No. ");
                    alrtText.append(authPoNo);
                    alrtText.append(" dated ");
                    alrtText.append(drftpoRw.getAttribute("PoDt"));
                    alrtText.append(" ");
                    alrtText.append(drftpoRw.getAttribute("TransEoId"));
                    for (Row rP : rr) {
                        advncAmt = advncAmt.add((Number) rP.getAttribute("PayAmt"));
                        alrtText.append(" for amount ");
                        alrtText.append(currNotation);
                        alrtText.append(" ");
                        alrtText.append(rP.getAttribute("PayAmt"));
                        alrtText.append(" on ");
                        alrtText.append(rP.getAttribute("PayDt"));
                    }
                    alrtText.append(" .");

                    _log.info("altert text " + alrtText.toString());

                    callStoredFunctionLatest("APP.PR_ALRT_EVNT_BASED(?,?,?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                             cld_id, slocId, hoOrg_id, orgId, 18504, drftpoRw.getAttribute("PoType"),
                                             25, userId, "00305", docId, "Advance payment alert", alrtText.toString()
                    });


                    Object insFinPR = (callStoredFunction(Types.VARCHAR, "FIN.FN_INS_IR(?,?,?,?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                                          cld_id, 1, slocId, hoOrg_id, orgId, docId, 18504, "PROJ0000",
                                                          drftpoRw.getAttribute("EoId"),
                                                          drftpoRw.getAttribute("CurrIdSp"),
                                                          drftpoRw.getAttribute("CurrConvFctr"),
                                                          drftpoRw.getAttribute("UsrIdCreate"),
                                                          drftpoRw.getAttribute("UsrIdCreateDt")
                    }));

                    _log.info("insFinPR  " + insFinPR);
                    System.out.println("insFinPR  " + insFinPR);
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }


    protected BigDecimal callStoredFunctionLatest(String stmt, Object[] bindVars) {
        //used to get latest price
        _log.info("callStoredFunctionLatest ");
        CallableStatement st = null;
        try {
            /** 1. Create a JDBC CallabledStatement */

            st = this.getDBTransaction().createCallableStatement("begin " + stmt + ";end;", 0);
            /** 2. Register the first bind variable for the return value. and last 2 variable for output variable of function. */
            st.setObject(1, bindVars[0]);
            st.setObject(2, bindVars[1]);
            st.setObject(3, bindVars[2]);
            st.setObject(4, bindVars[3]);
            st.setObject(5, bindVars[4]);
            st.setObject(6, bindVars[5]);
            st.setObject(7, bindVars[6]);
            st.setObject(8, bindVars[7]);
            st.setObject(9, bindVars[8]);
            st.setObject(10, bindVars[9]);
            st.setObject(11, bindVars[10]);
            st.setObject(12, bindVars[11]);
            /** 5. Set the value of user-supplied bind vars in the stmt */
            st.executeUpdate();
            BigDecimal bb = new BigDecimal(0);

            return bb;
        } catch (SQLException e) {
            int end = e.getMessage().indexOf("\n");

            throw new JboException(e.getMessage());
        } finally {
            if (st != null) {
                try {
                    /** 7. Close the statement */
                    st.close();
                } catch (SQLException e) {

                }
            }
        }
    }


    /**
     * Method which will push data of Cost Center from TempCostCenter to SlsSoCostCenter Table
     */
    public void sendDateFromTempCcToSlsSoCc() {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        if (chkCcApplicableOrNot()) {
            callStoredFunction(Types.VARCHAR, "APP.FN_SAVE_COST_CENTER(?,?,?,?,?,?,?,?)", new Object[] {
                               cld_id, slocId, hoOrg_id, orgId, 18504, "MM", "MM$DRFT$PO$COST$CENTER",
                               this.getMmDrftPo().getCurrentRow().getAttribute("DocId")
            });
        }
    }
    /*  public void revertAndReject(){
        ViewObjectImpl drftPo=getMmDrftPo();
        Row drftpoRw=drftPo.getCurrentRow();
        String docId=drftpoRw.getAttribute("DocId").toString();
        String whid=null;
        Integer fyid=Integer.parseInt(drftpoRw.getAttribute("FyId").toString());
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        Integer userId = Integer.parseInt(drftpoRw.getAttribute("UsrIdCreate").toString());

        pendingPOCheck(slocId,cld_id,orgId,18504)

    } */

    public Integer pendingPOCheck(Integer SlocId, String CldId, String OrgId, Integer PoDocNo) {
        Row currPO = this.getMmDrftPo().getCurrentRow();
        String docIdTxn = currPO.getAttribute("DocId").toString();
        System.out.println("DOCIDTXN--" + docIdTxn);
        Integer poType = (Integer) currPO.getAttribute("PoType");
        Object obj = callStoredFunction(NUMBER, "APP.WF_GET_CUR_USR(?,?,?,?,?,?)", new Object[] {
                                        SlocId, CldId, OrgId, PoDocNo, docIdTxn, poType
        });
        Integer usrId = null;
        if (obj != null) {
            usrId = Integer.parseInt(obj.toString());
        }
        /*   Integer.parseInt(callStoredFunction(NUMBER, "APP.PKG_APP_WF.GET_DOC_WF_CUR_USR(?,?,?,?,?)", new Object[] { SlocId,
                                                                                                                   CldId,
                                                                                                                   OrgId,
                                                                                                                   PoDocNo,
                                                                                                                   docIdTxn }).toString()); */
        System.out.println("User id pending in impl--" + usrId);
        return usrId;

    }

    public String getWfNo(Integer sloc_id, String cld_id, String org_id, Integer doc_no) {
        try {
            Integer poType = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("PoType");
            System.out.println("Sloc=" + sloc_id + " and cld_id=" + cld_id + "and org_id=" + org_id + " and doc_no=" +
                               doc_no + " and PoType=" + poType);
            Object obj = callStoredFunction(Types.VARCHAR, "APP.WF_GET_ID(?,?,?,?,?)", new Object[] {
                                            sloc_id, cld_id, org_id, doc_no, poType
            });
            _log.info("WFNO in AMimpl:" + obj);
            return obj.toString();
        } catch (Exception e) {
            System.out.println("GETWFNO--" + e);
            return "0";
        }
    }

    public Integer getUsrLvl(Integer SlocId, String CldId, String OrgId, Integer usr_id, String WfNum, String PoDocId) {
        Integer poType = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("PoType");

        return Integer.parseInt(callStoredFunction(NUMBER, "APP.WF_GET_USR_LEVEL(?,?,?,?,?,?,?)", new Object[] {
                                                   SlocId, CldId, OrgId, usr_id, WfNum, PoDocId, poType
    }).toString());


    }

    public Integer insIntoTxn(Integer sloc_id, String cld_id, String pOrgId, Integer PO_DOC_NO, String WfNum,
                              String poDocId, Integer usr_idFrm, Integer usr_idTo, Integer levelTo, Integer levelFrm,
                              String action, String remark, Number amount, String post) {

        Integer poType = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("PoType");

        return Integer.parseInt(callStoredFunction(NUMBER, "APP.WF_INS_TXN(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                                   sloc_id, cld_id, pOrgId, PO_DOC_NO, poType, WfNum, poDocId,
                                                   usr_idFrm, usr_idTo, levelFrm, levelTo, action, remark, amount, post
    }).toString());

    }

    public String resolvEl(String data) {
        FacesContext fc = FacesContext.getCurrentInstance();
        Application app = fc.getApplication();
        ExpressionFactory elFactory = app.getExpressionFactory();
        ELContext elContext = fc.getELContext();
        ValueExpression valueExp = elFactory.createValueExpression(elContext, data, Object.class);
        String Message = valueExp.getValue(elContext).toString();
        return Message;
    }

    public Object resolvElO(String data) {
        FacesContext fc = FacesContext.getCurrentInstance();
        Application app = fc.getApplication();
        ExpressionFactory elFactory = app.getExpressionFactory();
        ELContext elContext = fc.getELContext();
        ValueExpression valueExp = elFactory.createValueExpression(elContext, data, Object.class);
        return valueExp.getValue(elContext);
    }

    /** Function to call a database procedure.
     * @param stmt
     * @param bindVars
     * @throws SQLException
     */
    public void callStoredProcedure(String stmt, Object[] bindVars) {
        PreparedStatement st = null;
        try {
            st = getDBTransaction().createPreparedStatement("begin " + stmt + "; end;", 0);
            if (bindVars != null) {
                for (int z = 0; z < bindVars.length; z++) {
                    st.setObject(z + 1, bindVars[z]);
                }
            }
            st.executeUpdate();
        } catch (SQLException e) {

            System.out.println(e.getMessage() + " " + e);
            int end = e.getMessage().indexOf("\n");
            String message = e.getMessage().substring(11, end);
            FacesMessage ermsg = new FacesMessage(message);
            ermsg.setSeverity(FacesMessage.SEVERITY_ERROR);
            FacesContext.getCurrentInstance().addMessage(null, ermsg);
        } finally {
            if (st != null) {
                try {
                    st.close();
                } catch (SQLException e) {
                    throw new JboException(e.getMessage());
                }
            }
        }
    }

    protected Object callStoredFunction(int sqlReturnType, String stmt, Object[] bindVars) {

        CallableStatement st = null;
        try {
            // 1. Create a JDBC CallabledStatement
            st = getDBTransaction().createCallableStatement("begin ? := " + stmt + ";end;", 0);
            // 2. Register the first bind variable for the return value
            st.registerOutParameter(1, sqlReturnType);

            if (bindVars != null) {
                // 3. Loop over values for the bind variables passed in, if any
                for (int z = 0; z < bindVars.length; z++) {
                    // 4. Set the value of user-supplied bind vars in the stmt
                    st.setObject(z + 2, bindVars[z]);
                }
            }
            // 5. Set the value of user-supplied bind vars in the stmt
            st.executeUpdate();
            // 6. Return the value of the first bind variable
            //  System.out.println("Function return " + st.getObject(1));
            return st.getObject(1);
        } catch (SQLException e) {
            int end = e.getMessage().indexOf("\n");
            //  throw new JboException(e.getMessage().substring(11, end));
            String msg = e.getMessage(); //.substring(11, end);

            FacesMessage ermsg = new FacesMessage(msg);
            ermsg.setSeverity(FacesMessage.SEVERITY_ERROR);
            FacesContext.getCurrentInstance().addMessage(null, ermsg);
            return null;


        } finally {
            if (st != null) {
                try {
                    // 7. Close the statement
                    st.close();
                } catch (SQLException e) {
                    throw new JboException(e.getMessage());
                }
            }
        }
    }

    /**
     * Container's getter for LovPoMode.
     * @return LovPoMode
     */
    public ViewObjectImpl getLovPoMode() {
        return (ViewObjectImpl) findViewObject("LovPoMode");
    }

    /**
     * Container's getter for LovUsrId.
     * @return LovUsrId
     */
    public ViewObjectImpl getLovUsrId() {
        return (ViewObjectImpl) findViewObject("LovUsrId");
    }

    public String amendPo(String P_CLDID, String p_orgid, Integer p_slocid, String p_doc_id, String p_ref_doc_id,
                          Integer p_usr_id) {
        String amendOk = callStoredFunction(STRING, "MM.MM_AMEND_PO(?,?,?,?,?,?)", new Object[] {
                                            P_CLDID, p_orgid, p_slocid, p_doc_id, p_ref_doc_id, p_usr_id
        }).toString();
        return amendOk;
    }

    /**
     * Container's getter for OrgMmPrf1.
     * @return OrgMmPrf1
     */
    public ViewObjectImpl getOrgMmPrf1() {
        return (ViewObjectImpl) findViewObject("OrgMmPrf1");
    }

    /**
     * Container's getter for LovCurrency.
     * @return LovCurrency
     */
    public ViewObjectImpl getLovCurrency() {
        return (ViewObjectImpl) findViewObject("LovCurrency");
    }

    /**
     * Container's getter for LovUomVw1.
     * @return LovUomVw1
     */
    public ViewObjectImpl getLovUomVw1() {
        return (ViewObjectImpl) findViewObject("LovUomVw1");
    }

    /**
     * Container's getter for MmDrftPoTrLinesVO1.
     * @return MmDrftPoTrLinesVO1
     */
    public MmDrftPoTrLinesVOImpl getMmDrftPoTrLinesVO1() {
        return (MmDrftPoTrLinesVOImpl) findViewObject("MmDrftPoTrLinesVO1");
    }

    /**
     * Container's getter for MmDrftPoTr1.
     * @return MmDrftPoTr1
     */
    public MmDrftPoTrVOImpl getMmDrftPoTr1() {
        return (MmDrftPoTrVOImpl) findViewObject("MmDrftPoTr1");
    }

    /**
     * Container's getter for MmDrftPoItmToTrVL1.
     * @return MmDrftPoItmToTrVL1
     */
    public ViewLinkImpl getMmDrftPoItmToTrVL1() {
        return (ViewLinkImpl) findViewLink("MmDrftPoItmToTrVL1");
    }

    /**
     * Container's getter for MmDrftPoTrLines1.
     * @return MmDrftPoTrLines1
     */
    public MmDrftPoTrLinesVOImpl getMmDrftPoTrLines1() {
        return (MmDrftPoTrLinesVOImpl) findViewObject("MmDrftPoTrLines1");
    }

    /**
     * Container's getter for DrftPoTrToDrftPoTrLinesVL2.
     * @return DrftPoTrToDrftPoTrLinesVL2
     */
    public ViewLinkImpl getDrftPoTrToDrftPoTrLinesVL2() {
        return (ViewLinkImpl) findViewLink("DrftPoTrToDrftPoTrLinesVL2");
    }

    /**
     * Container's getter for MmDrftPoItm1.
     * @return MmDrftPoItm1
     */
    public MmDrftPoItmVOImpl getMmDrftPoItm1() {
        return (MmDrftPoItmVOImpl) findViewObject("MmDrftPoItm1");
    }

    /**
     * Container's getter for MmDrftPoOc1.
     * @return MmDrftPoOc1
     */
    public MmDrftPoOcVOImpl getMmDrftPoOc1() {
        return (MmDrftPoOcVOImpl) findViewObject("MmDrftPoOc1");
    }

    /**
     * Container's getter for MmDrftPoPmtSchdl1.
     * @return MmDrftPoPmtSchdl1
     */
    public ViewObjectImpl getMmDrftPoPmtSchdl1() {
        return (ViewObjectImpl) findViewObject("MmDrftPoPmtSchdl1");
    }

    /**
     * Container's getter for MmDrftPoTr2.
     * @return MmDrftPoTr2
     */
    public MmDrftPoTrVOImpl getMmDrftPoTr2() {
        return (MmDrftPoTrVOImpl) findViewObject("MmDrftPoTr2");
    }

    /**
     * Container's getter for MmDrftPoDlvSchdl1.
     * @return MmDrftPoDlvSchdl1
     */
    public MmDrftPoDlvSchdlVOImpl getMmDrftPoDlvSchdl1() {
        return (MmDrftPoDlvSchdlVOImpl) findViewObject("MmDrftPoDlvSchdl1");
    }

    /**
     * Container's getter for MmDrftPoTnc1.
     * @return MmDrftPoTnc1
     */
    public MmDrftPoTncVOImpl getMmDrftPoTnc1() {
        return (MmDrftPoTncVOImpl) findViewObject("MmDrftPoTnc1");
    }

    /**
     * Container's getter for LovOpenOrdBasis.
     * @return LovOpenOrdBasis
     */
    public ViewObjectImpl getLovOpenOrdBasis() {
        return (ViewObjectImpl) findViewObject("LovOpenOrdBasis");
    }

    /**
     * Container's getter for MmDrftPo1.
     * @return MmDrftPo1
     */
    public MmDrftPoVOImpl getMmDrftPo1() {
        return (MmDrftPoVOImpl) findViewObject("MmDrftPo1");
    }

    /**
     * Container's getter for AppEoPricePlc.
     * @return AppEoPricePlc
     */
    public ViewObjectImpl getAppEoPricePlc() {
        return (ViewObjectImpl) findViewObject("AppEoPricePlc");
    }

    public void criteriaForSupplierList() {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC}"));
        ViewObjectImpl eoVo = this.getLovEoId();
        ViewCriteria vc = eoVo.getViewCriteria("LovEoIdVOCriteria");
        eoVo.setNamedWhereClauseParam("slocIdBind", slocId);
        eoVo.setNamedWhereClauseParam("hoOrgIdBind", hoOrg_id);
        eoVo.setNamedWhereClauseParam("cldIdBind", cld_id);
        eoVo.setNamedWhereClauseParam("orgIdBind", orgId);
        eoVo.applyViewCriteria(vc);
        eoVo.executeQuery();

        ViewObjectImpl tncVo = this.getLovTncId();
        ViewCriteria vctnc = eoVo.getViewCriteria("LovTncIdCriteria");
        tncVo.setNamedWhereClauseParam("slocIdBind", slocId);
        tncVo.setNamedWhereClauseParam("cldBind", cld_id);
        tncVo.setNamedWhereClauseParam("orgBind", orgId);
        tncVo.applyViewCriteria(vctnc);
        tncVo.executeQuery();


        ViewObjectImpl tncVo1 = this.getLovTncId();
        tncVo1.setNamedWhereClauseParam("BindSlocId", slocId);
        tncVo1.setNamedWhereClauseParam("BindCldId", cld_id);
        tncVo1.setNamedWhereClauseParam("BindOrgId", orgId);
        tncVo1.executeQuery();

        this.getOcImpView().setNamedWhereClauseParam("CldIdBind", cld_id);
        this.getOcImpView().setNamedWhereClauseParam("SlocIdBind", slocId);
        this.getOcImpView().setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
        this.getOcImpView().setNamedWhereClauseParam("DocIdBind", 18504);
        this.getOcImpView().setNamedWhereClauseParam("DocTypeIdBind", 741);
        this.getOcImpView().executeQuery();


    }

    public void CancelOrShortclosePo(String vis) {
        System.out.println("1.variable=" + vis);

        String wfRet = null;
        if (resolvEl("#{pageFlowScope.WF_RET_VALUE}") != null) {
            wfRet = resolvEl("#{pageFlowScope.WF_RET_VALUE}");
            if (wfRet.equals("A")) {
                System.out.println("variable=" + vis);
                if (vis.equals("C"))
                    this.getMmDrftPo().getCurrentRow().setAttribute("PoStatus", 220);
                else if (vis.equals("S"))
                    this.getMmDrftPo().getCurrentRow().setAttribute("PoStatus", 219);
                String CldId = (String) this.getMmDrftPo().getCurrentRow().getAttribute("CldId");
                Integer SlocId = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("SlocId");
                String OrgId = (String) this.getMmDrftPo().getCurrentRow().getAttribute("OrgId");
                Integer FyId = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("FyId");
                String DocId = (String) this.getMmDrftPo().getCurrentRow().getAttribute("DocId");
                this.getDBTransaction().commit();
                System.out.println("Parameters are as, DocId=" + DocId);
                Object ret = (Object) callStoredFunction(NUMBER, "MM.MM_UPDT_ORD_STK(?,?,?,?,?)", new Object[] {
                                                         CldId, SlocId, OrgId, FyId, DocId
                });
            } else if (wfRet.equals("R")) {
                this.getMmDrftPo().getCurrentRow().setAttribute("PoStatus", 217);
            } else if (wfRet.equals("V")) {
                String CldId = (String) this.getMmDrftPo().getCurrentRow().getAttribute("CldId");
                Integer SlocId = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("SlocId");
                String OrgId = (String) this.getMmDrftPo().getCurrentRow().getAttribute("OrgId");
                Integer usrPend = null;
                usrPend = pendingPOCheck(SlocId, CldId, OrgId, 18504);
                Integer usrCrt = (Integer) this.getMmDrftPo().getCurrentRow().getAttribute("UsrIdCreate");
                if (usrPend != null && usrPend.compareTo(usrCrt) == 0)
                    this.getMmDrftPo().getCurrentRow().setAttribute("PoStatus", 217);
            }
        }
    }

    /**
     * Container's getter for LovAppPricePlc.
     * @return LovAppPricePlc
     */
    public ViewObjectImpl getLovAppPricePlc() {
        return (ViewObjectImpl) findViewObject("LovAppPricePlc");
    }

    public Integer checkOpenPurchaseValidity(String orgId, String cldId, Integer slocId, String refDocId) {

        ViewObjectImpl refVo = this.getLovRefPoDocId();
        RowQualifier rq = new RowQualifier(refVo);
        rq.setWhereClause("CldId = '" + cldId + "' and OrgId = '" + orgId + "' and SlocId = " + slocId +
                          " and DocId = '" + refDocId + "'  ");
        Row[] rr = refVo.getFilteredRows(rq);
        _log.info(rq.getExprStr() + "  row lenth      " + rr.length);
        Date date = null;
        Date dateCurr = (Date) new Date().getCurrentDate();
        _log.info(" curr date " + dateCurr);
        if (rr.length > 0) {
            date = (Date) rr[0].getAttribute("ValidToDt");
        }
        _log.info(dateCurr.dateValue() + " date value " + dateCurr + " currdate " + date + "dateCurr.compareTo(date) " +
                  dateCurr.compareTo(date));
        _log.info("dateCurr.dateValue().toString() " + dateCurr.dateValue().toString());
        _log.info("dateCurr.dateValue().toString() " + date.dateValue().toString());
        _log.info("date compa " + dateCurr.dateValue().toString().compareTo(date.dateValue().toString()));


        if (date != null) {
            if (dateCurr.dateValue().toString().compareTo(date.dateValue().toString()) > 0) {
                return 1;
            } else {
                return 0;
            }

        } else {
            return 0;
        }
    }

    public Integer checkOpenPurchaseDateValidity(Date opDate) {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        ViewObjectImpl poVo = this.getMmDrftPo();
        Row curR = poVo.getCurrentRow();
        ViewObjectImpl refVo = this.getLovRefPoDocId();
        RowQualifier rq = new RowQualifier(refVo);
        rq.setWhereClause("CldId = '" + cldId + "' and OrgId = '" + orgId + "' and SlocId = " + slocId +
                          " and DocId = '" + curR.getAttribute("RefPoDocId").toString() + "' ");
        Row[] rr = refVo.getFilteredRows(rq);
        _log.info(rq.getExprStr() + "  row lenth      " + rr.length);
        Date dateUpto = null;
        Date dateFrom = null;
        /* Date dateCurr =
            (Date)new Date().getCurrentDate();
        _log.info(" curr date "+dateCurr); */
        if (rr.length > 0) {
            dateUpto = (Date) rr[0].getAttribute("ValidToDt");
            dateFrom = (Date) rr[0].getAttribute("ValidFrmDt");
        }
        _log.info(opDate + " po  date   " + dateUpto + "  ref po date upto   " + dateFrom + " ref doc from " +
                  opDate.compareTo(dateUpto) + " from " + opDate.compareTo(dateFrom));
        if (dateFrom != null && dateUpto != null) {
            if (opDate.compareTo(dateFrom) < 0) {
                return 1;
            } else if (opDate.compareTo(dateUpto) > 0) {
                return 2;
            } else {
                return 0;
            }

        } else {
            return 0;
        }
    }

    /**
     * Container's getter for LovItmIdNew.
     * @return LovItmIdNew
     */
    public LovItmIdNewVOImpl getLovItmIdNew() {
        return (LovItmIdNewVOImpl) findViewObject("LovItmIdNew");
    }

    /**
     * Container's getter for LovItmDesc.
     * @return LovItmDesc
     */
    public ViewObjectImpl getLovItmDesc() {
        return (ViewObjectImpl) findViewObject("LovItmDesc");
    }

    /**
     * Container's getter for LovCoaTune.
     * @return LovCoaTune
     */
    public ViewObjectImpl getLovCoaTune() {
        return (ViewObjectImpl) findViewObject("LovCoaTune");
    }

    /**
     * Container's getter for MmDrftPoContnr.
     * @return MmDrftPoContnr
     */
    public ViewObjectImpl getMmDrftPoContnr() {
        return (ViewObjectImpl) findViewObject("MmDrftPoContnr");
    }

    /**
     * Container's getter for DrftPoToDrftPoContnrVL1.
     * @return DrftPoToDrftPoContnrVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoContnrVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoContnrVL1");
    }

    /**
     * Container's getter for MmDrftPoPorts.
     * @return MmDrftPoPorts
     */
    public ViewObjectImpl getMmDrftPoPorts() {
        return (ViewObjectImpl) findViewObject("MmDrftPoPorts");
    }

    /**
     * Container's getter for DrftPoToDrftPoPortsVL1.
     * @return DrftPoToDrftPoPortsVL1
     */
    public ViewLinkImpl getDrftPoToDrftPoPortsVL1() {
        return (ViewLinkImpl) findViewLink("DrftPoToDrftPoPortsVL1");
    }

    public void addContainerDetails() {
        ViewObjectImpl poVo = this.getMmDrftPo();
        Row poR = poVo.getCurrentRow();
        if (poR.getAttribute("TransContnrNm") != null && poR.getAttribute("TransContnrSize") != null &&
            poR.getAttribute("TransContnrQty") != null) {
            Row contnrR = this.getMmDrftPoContnr().createRow();
            contnrR.setAttribute("ContNm", poR.getAttribute("TransContnrNm").toString());
            contnrR.setAttribute("ContSize", poR.getAttribute("TransContnrSize").toString());
            contnrR.setAttribute("ContQty", (Number) poR.getAttribute("TransContnrQty"));
            this.getMmDrftPoContnr().insertRow(contnrR);
        }
        poR.setAttribute("TransContnrNm", null);
        poR.setAttribute("TransContnrSize", null);
        poR.setAttribute("TransContnrQty", null);
    }

    public void addPortsDetails(Integer trvlSeqNo) {
        _log.info(trvlSeqNo + " trvlSeqNo:::::::::");
        ViewObjectImpl poVo = this.getMmDrftPo();
        Row poR = poVo.getCurrentRow();
        if (poR.getAttribute("TransPortsNm") != null) {
            ViewObjectImpl voport = this.getLovPortId();
            String portId = null;
            Row[] rr = voport.getFilteredRows("PortNm", poR.getAttribute("TransPortsNm").toString());
            if (rr.length > 0) {
                portId = rr[0].getAttribute("PortId").toString();
            }
            if (portId != null) {
                Row portsR = this.getMmDrftPoPorts().createRow();
                portsR.setAttribute("PortId", portId);
                portsR.setAttribute("TrvlSeq", trvlSeqNo);
                portsR.setAttribute("Eta", poR.getAttribute("TransEtaDate"));
                portsR.setAttribute("Etd", poR.getAttribute("TransEtdDate"));
                portsR.setAttribute("Remarks", poR.getAttribute("TransPortRemarks"));
                this.getMmDrftPoPorts().insertRow(portsR);
            }
        }
        poR.setAttribute("TransPortsNm", null);
        poR.setAttribute("TransEtaDate", null);
        poR.setAttribute("TransEtdDate", null);
        poR.setAttribute("TransPortRemarks", null);
    }

    public String isPartNameDuplicate(String porName) {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        ViewObjectImpl poVo = this.getMmDrftPo();
        ViewObjectImpl poPortVo = this.getMmDrftPoPorts1();
        Row poR = poVo.getCurrentRow();
        if (porName != null) {
            ViewObjectImpl voport = this.getLovPortId();
            String portId = null;
            Row[] rr = voport.getFilteredRows("PortNm", porName);
            if (rr.length > 0) {
                portId = rr[0].getAttribute("PortId").toString();
            }
            if (portId != null) {
                RowQualifier rqPort = new RowQualifier(poPortVo);
                rqPort.setWhereClause("CldId ='" + cldId + "' and SlocId =" + slocId + " and OrgId ='" + orgId +
                                      "' and DocId ='" + poR.getAttribute("DocId").toString() + "' and PortId = '" +
                                      portId + "' ");
                Row[] rrP = poPortVo.getFilteredRows(rqPort);
                _log.info(rqPort.getExprStr() + "   ::    " + rrP.length);
                if (rrP.length > 0) {
                    return "Y";
                } else {
                    return "N";
                }
            } else {
                return "N";
            }
        } else {
            return "N";
        }
    }


    public String isContainerNameDuplicate(String cntnrName) {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        ViewObjectImpl poVo = this.getMmDrftPo();
        ViewObjectImpl poPortVo = this.getMmDrftPoContnr1();
        Row poR = poVo.getCurrentRow();
        if (cntnrName != null) {
            RowQualifier rqPort = new RowQualifier(poPortVo);
            rqPort.setWhereClause("CldId ='" + cldId + "' and SlocId =" + slocId + " and OrgId ='" + orgId +
                                  "' and DocId ='" + poR.getAttribute("DocId").toString() + "' and ContNm = '" +
                                  cntnrName + "' ");
            Row[] rrP = poPortVo.getFilteredRows(rqPort);
            _log.info(rqPort.getExprStr() + "   ::    " + rrP.length);
            if (rrP.length > 0) {
                return "Y";
            } else {
                return "N";
            }
        } else {
            return "N";
        }
    }

    /**
     * Container's getter for LovPortId.
     * @return LovPortId
     */
    public ViewObjectImpl getLovPortId() {
        return (ViewObjectImpl) findViewObject("LovPortId");
    }

    /**
     * Container's getter for LovCfa.
     * @return LovCfa
     */
    public ViewObjectImpl getLovCfa() {
        return (ViewObjectImpl) findViewObject("LovCfa");
    }

    /**
     * Container's getter for LovShippingCompany.
     * @return LovShippingCompany
     */
    public ViewObjectImpl getLovShippingCompany() {
        return (ViewObjectImpl) findViewObject("LovShippingCompany");
    }

    /**
     * Container's getter for LovShippingCfa.
     * @return LovShippingCfa
     */
    public ViewObjectImpl getLovShippingCfa() {
        return (ViewObjectImpl) findViewObject("LovShippingCfa");
    }

    /**
     * Container's getter for MmDrftPoPorts1.
     * @return MmDrftPoPorts1
     */
    public ViewObjectImpl getMmDrftPoPorts1() {
        return (ViewObjectImpl) findViewObject("MmDrftPoPorts1");
    }

    /**
     * Container's getter for MmDrftPoContnr1.
     * @return MmDrftPoContnr1
     */
    public ViewObjectImpl getMmDrftPoContnr1() {
        return (ViewObjectImpl) findViewObject("MmDrftPoContnr1");
    }

    /**
     * Container's getter for LovItmForAutoSuggest1.
     * @return LovItmForAutoSuggest1
     */
    public ViewObjectImpl getLovItmForAutoSuggest() {
        return (ViewObjectImpl) findViewObject("LovItmForAutoSuggest");
    }

    /**
     * Method to get suggested Item in AutoSuggest.
     * @param itmStr
     * @return
     */
    public ArrayList<String> getSuggestedItemDesc(String itmStr) {
        ViewObjectImpl vo = this.getMmDrftPo();
        Integer poType = (Integer) vo.getCurrentRow().getAttribute("PoType");
        ArrayList<String> h = new ArrayList<String>();
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        if (poType.compareTo(new Integer(881)) == 0) {
            ViewObjectImpl autoSuggestVO = this.getLovItmForAutoSuggestCpoVoVO();
            autoSuggestVO.setNamedWhereClauseParam("CldIdBind", cld_id);
            autoSuggestVO.setNamedWhereClauseParam("SlocIdBind", slocId);
            autoSuggestVO.setNamedWhereClauseParam("OrgIdbind", orgId);
            autoSuggestVO.setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
            autoSuggestVO.setNamedWhereClauseParam("ItmNmbind", itmStr);
            //  autoSuggestVO.setNamedWhereClauseParam("SampleItmFlgBind", smpl);
            autoSuggestVO.executeQuery();
            autoSuggestVO.setRangeSize(12);
            for (Row r : autoSuggestVO.getAllRowsInRange()) {
                h.add(r.getAttribute("ItmDesc").toString());
            }

        } else {

            ViewObjectImpl autoSuggestVO = this.getLovItmForAutoSuggest();
            autoSuggestVO.setNamedWhereClauseParam("CldIdBind", cld_id);
            autoSuggestVO.setNamedWhereClauseParam("SlocIdBind", slocId);
            autoSuggestVO.setNamedWhereClauseParam("OrgIdbind", orgId);
            autoSuggestVO.setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
            autoSuggestVO.setNamedWhereClauseParam("ItmNmbind", itmStr);
            //  autoSuggestVO.setNamedWhereClauseParam("SampleItmFlgBind", smpl);
            autoSuggestVO.executeQuery();
            autoSuggestVO.setRangeSize(12);
            for (Row r : autoSuggestVO.getAllRowsInRange()) {
                h.add(r.getAttribute("ItmDesc").toString());
            }
        }
        return h;
    }


    /**
     * Method to get suggested Supplier name in AutoSuggest.
     * @param eoStr
     * @return
     */
    public ArrayList<String> getSuggestedSupplierNm(String eoStr) {
        ArrayList<String> h = new ArrayList<String>();
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        ViewObjectImpl autoSuggestVO = this.getLovSupplierForAutoSuggest();
        autoSuggestVO.setNamedWhereClauseParam("CldIdBind", cld_id);
        autoSuggestVO.setNamedWhereClauseParam("SlocIdBind", slocId);
        autoSuggestVO.setNamedWhereClauseParam("OrgIdBind", orgId);
        autoSuggestVO.setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
        autoSuggestVO.setNamedWhereClauseParam("EoNmBind", eoStr);
        //  autoSuggestVO.setNamedWhereClauseParam("SampleItmFlgBind", smpl);
        autoSuggestVO.executeQuery();
        autoSuggestVO.setRangeSize(12);
        for (Row r : autoSuggestVO.getAllRowsInRange()) {
            h.add(r.getAttribute("EoNm").toString());
        }
        return h;
    }


    public String applyDirectTax(String itmId, String uom) {

        _log.info("call direct tax :::: ");

        //  Row trcurr = getAm().getMmDrftPoTr1().getCurrentRow();
        Integer p_sloc_id = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        Integer p_user_id = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        String p_org_id = (String) resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String p_hoOrgId = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}").toString();
        String p_cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}").toString();


        // String p_doc_id = trcurr.getAttribute("DocId").toString();
        Number p_curr_fctr = new Number(1);
        String retflg = "Y";
        String itmGroup = null;
        String taxRuleFlg = "I";
        String taxExpt = "N";
        Integer taxRuleId = 0;
        String addsId = null;
        Number p_taxable_amount = zero;
        ViewObjectImpl poVo = this.getMmDrftPo();
        ViewObjectImpl poItmVo = this.getMmDrftPoItm();
        ViewObjectImpl poTrVo = this.getMmDrftPoTr();
        ViewObjectImpl poTrLineLines = this.getMmDrftPoTrLines1();
        Row poRow = poVo.getCurrentRow();
        Row itmRow = poItmVo.getCurrentRow();
        String docId = poRow.getAttribute("DocId").toString();
        Integer eoId = Integer.parseInt(poRow.getAttribute("EoId").toString());
        if (poRow.getAttribute("BillAddsId") != null) {
            addsId = poRow.getAttribute("BillAddsId").toString();
        }
        this.getLovItmIdNew().setNamedWhereClauseParam("CldIdBind", p_cldId);
        this.getLovItmIdNew().setNamedWhereClauseParam("SlocIdBind", p_sloc_id);
        this.getLovItmIdNew().setNamedWhereClauseParam("HoOrgIdBind", p_hoOrgId);
        this.getLovItmIdNew().setNamedWhereClauseParam("OrgIdBind", p_org_id);
        this.getLovItmIdNew().setNamedWhereClauseParam("ItmIdBind", itmId);
        this.getLovItmIdNew().executeQuery();

        Row[] itms = this.getLovItmIdNew().getFilteredRows("ItmId", itmId);
        _log.info("lenth   " + itms.length);
        if (itms.length > 0) {
            if (itms[0].getAttribute("TaxExmptFlg") != null) {
                taxExpt = itms[0].getAttribute("TaxExmptFlg").toString();
            }
            if (itms[0].getAttribute("TaxRuleId") != null) {
                taxRuleId = Integer.parseInt(itms[0].getAttribute("TaxRuleId").toString());
            }
            if (itms[0].getAttribute("GrpId") != null) {
                itmGroup = itms[0].getAttribute("GrpId").toString();
            }
        }


        if (poRow.getAttribute("TaxAfterDiscFlg") != null) {
            if ("N".equalsIgnoreCase(poRow.getAttribute("TaxAfterDiscFlg").toString())) {
                p_taxable_amount = (Number) itmRow.getAttribute("TransItemAmtWoutDc");
            } else if ("Y".equalsIgnoreCase(poRow.getAttribute("TaxAfterDiscFlg").toString())) {
                p_taxable_amount = (Number) itmRow.getAttribute("TransItmAmtSp");
            }
        }
        if (poRow.getAttribute("CurrConvFctr") != null) {
            p_curr_fctr = (Number) poRow.getAttribute("CurrConvFctr");
        }
        _log.info(taxRuleId + "     " + p_taxable_amount + "    Tax rule flg=I");
        if ("Y".equalsIgnoreCase(taxExpt)) {
            retflg = "N";
        } else {

            if (addsId == null || eoId == null || itmGroup == null) {
                retflg = "E";
            } else {

                Object taxRuleG = callStoredFunction(Types.INTEGER, "APP.FN_GET_TAX_RULE_ID(?,?,?,?,?,?,?,?,?)", new Object[] {
                                                     p_cldId, p_sloc_id, addsId, p_org_id, p_hoOrgId, itmId, eoId,
                                                     18504, null
                });

                _log.info("taxRuleG  : " + taxRuleG);

                if (taxRuleG != null) {

                    Integer taxRuleForEo = (Integer) taxRuleG;
                    _log.info("taxRuleG  " + taxRuleG);
                    if (taxRuleForEo.compareTo(new Integer(-1)) == 0) {
                        return retflg = "R";
                    } else {
                        _log.info(taxRuleForEo + "  taxRuleForEo " + p_taxable_amount);
                        BigDecimal ret =
                            (BigDecimal) callStoredFunction(NUMBER,
                                                            "MM.MM_INS_PO_TR_LINES(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                                            p_sloc_id, p_cldId, p_hoOrgId, p_org_id, docId, itmId, uom,
                                                            taxRuleForEo, p_user_id, p_taxable_amount, p_taxable_amount,
                                                            "I", p_curr_fctr, taxExpt, "Y"
                        });


                        Number retVal = zero;
                        if (ret != null) {
                            try {
                                retVal = new Number(ret);
                            } catch (Exception e) {
                                e.printStackTrace();
                            }
                        }
                        _log.info(ret + "  ret1 " + retVal);

                        poTrVo.executeQuery();
                        this.getMmDrftPoTr1().executeQuery();
                        this.getMmDrftPoTr2().executeQuery();
                        poTrLineLines.executeQuery();
                        this.getMmDrftPoTrLines1().executeQuery();
                        this.getMmDrftPoTrLinesVO1().executeQuery();

                        // poItmVo.executeQuery();
                        itmRow.setAttribute("TransItemTaxAmt", retVal);
                        if (poTrVo.getCurrentRow() != null)
                            poTrVo.getCurrentRow().setAttribute("TaxAmt", retVal);
                        _log.info(itmRow.getAttribute("TransItemTaxAmt") + "   arg0   ");
                        if (poTrVo.getCurrentRow() != null) {
                            _log.info("" + poTrVo.getCurrentRow().getAttribute("TaxAmt"));
                        } else {
                            _log.info("current row tr null");
                        }
                        retflg = "Y";
                    }
                } else {
                    retflg = "R";
                }
            }
        }
        return retflg;
    }

    public Integer defaultTaxRuleForPo() {
        _log.info("defaultTaxRuleForPo ::");
        Integer p_sloc_id = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        Integer p_user_id = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        String p_org_id = (String) resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String p_hoOrgId = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}").toString();
        String p_cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}").toString();
        String addsId = null;
        ViewObjectImpl poVo = this.getMmDrftPo();
        Row poRow = poVo.getCurrentRow();
        Integer eoId = Integer.parseInt(poRow.getAttribute("EoId").toString());
        if (poRow.getAttribute("BillAddsId") != null) {
            addsId = poRow.getAttribute("BillAddsId").toString();
        }
        if (addsId != null || eoId != null) {

            Object taxRuleG = callStoredFunction(Types.INTEGER, "APP.FN_GET_TAX_RULE_ID(?,?,?,?,?,?,?,?,?)", new Object[] {
                                                 p_cldId, p_sloc_id, addsId, p_org_id, p_hoOrgId, "0", eoId, 18504, null
            });

            _log.info("defaultTaxRuleForPo ::" + taxRuleG);
            if (taxRuleG != null) {
                Integer taxR = (Integer) taxRuleG;
                _log.info("taxR   " + taxR);
                if (taxR.compareTo(new Integer(-1)) == 0) {
                    return -1;
                } else {
                    return taxR;
                }

            } else {
                return -1;
            }
        } else {
            return -2;
        }

    }

    /**
     * Container's getter for MmDrftPoCalc1.
     * @return MmDrftPoCalc1
     */
    public ViewObjectImpl getMmDrftPoCalc() {
        return (ViewObjectImpl) findViewObject("MmDrftPoCalc");
    }

    /**
     * Container's getter for MmDrftPoToMmDrftPoCalsVL1.
     * @return MmDrftPoToMmDrftPoCalsVL1
     */
    public ViewLinkImpl getMmDrftPoToMmDrftPoCalsVL1() {
        return (ViewLinkImpl) findViewLink("MmDrftPoToMmDrftPoCalsVL1");
    }

    /**
     * Method used to populate the invoice calculations
     * */
    public String populateCalculations(String p_cld_id, Integer p_sloc_id, String p_org_id, Integer p_usr_id) {
        ViewObjectImpl poVo = this.getMmDrftPo();
        ViewObjectImpl poCalcVo = this.getMmDrftPoCalc();
        Row rw = poVo.getCurrentRow();
        String p_doc_id = rw.getAttribute("DocId").toString();
        String paramHoOrdId = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        _log.info("p_doc_id  " + p_doc_id);
        Integer ret = 0;
        try {
            this.getDBTransaction().postChanges();

            ret = (Integer) (callStoredFunction(Types.INTEGER, "MM.MM_INS_PO_CALC(?,?,?,?,?)", new Object[] {
                                                p_sloc_id, p_cld_id, paramHoOrdId, p_org_id, p_doc_id
            }));
            poCalcVo.executeQuery();
            _log.info("ret    " + ret);
        } catch (Exception e) {
            FacesMessage message =
                new FacesMessage("There have been an error in calling function 'MM.MM_INS_PO_CALC' !" + e.getMessage());
            message.setSeverity(FacesMessage.SEVERITY_ERROR);
            FacesContext.getCurrentInstance().addMessage(null, message);
            e.printStackTrace();
        }
        if (ret != null) {
            if (ret > 0) {
                return "Y";
            } else {
                return "N";
            }
        } else {
            return "N";
        }
    }

    /**
     * Container's getter for LovEoNmView1.
     * @return LovEoNmView1
     */
    public ViewObjectImpl getLovEoNmView() {
        return (ViewObjectImpl) findViewObject("LovEoNmView");
    }

    /**
     * Container's getter for LovAddressView1.
     * @return LovAddressView1
     */
    public ViewObjectImpl getLovAddressView() {
        return (ViewObjectImpl) findViewObject("LovAddressView");
    }

    /**
     * Container's getter for LovCoaIdTaxView1.
     * @return LovCoaIdTaxView1
     */
    public ViewObjectImpl getLovCoaIdTaxView() {
        return (ViewObjectImpl) findViewObject("LovCoaIdTaxView");
    }

    /**
     * Container's getter for LovTaxTypeView1.
     * @return LovTaxTypeView1
     */
    public ViewObjectImpl getLovTaxTypeView() {
        return (ViewObjectImpl) findViewObject("LovTaxTypeView");
    }

    public void setCurrentOrgId() {

        if (this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") == null) {
            String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            _log.info("arg0 32 ");
            this.getMmDrftPo().getCurrentRow().setAttribute("OrgId", orgId);
            _log.info("arg0  " + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId"));
        }
    }

    /**
     * Container's getter for OcImpView1.
     * @return OcImpView1
     */
    public ViewObjectImpl getOcImpView() {
        return (ViewObjectImpl) findViewObject("OcImpView");
    }

    public Integer isOcDuplicate(String ocId) {
        ViewObjectImpl ocView = this.getMmDrftPoOc();
        RowQualifier rq = new RowQualifier(ocView);
        rq.setWhereClause("OrgId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") + "' and SlocId =" +
                          this.getMmDrftPo().getCurrentRow().getAttribute("SlocId") + " and CldId ='" +
                          this.getMmDrftPo().getCurrentRow().getAttribute("CldId") + "' and DocId ='" +
                          this.getMmDrftPo().getCurrentRow().getAttribute("DocId") + "' and OcId ='" + ocId + "' ");
        Row[] rr = ocView.getFilteredRows(rq);
        _log.info(rr.length + "  oc dupli  " + rq.getExprStr());
        if (rr.length > 0) {
            return 1;
        } else {
            return 0;
        }
    }

    public void addOthercharges(String ocId, Integer coaId, Integer ocCat) {
        if (ocId != null && coaId != null) {
            _log.info(ocId + "  oc id and coa Id " + coaId);
            Row rr = this.getMmDrftPoOc().createRow();
            rr.setAttribute("OcId", ocId);
            rr.setAttribute("CoaId", coaId);
            rr.setAttribute("OcDesc", ocCat);
            rr.setAttribute("CurrIdSpOc", this.getMmDrftPo().getCurrentRow().getAttribute("TransCurrIdBs"));
            rr.setAttribute("CurrConvFctrOc", 1);
            this.getMmDrftPoOc().insertRow(rr);
        }

    }

    public void addAllRequiredOC() {
        _log.info("addAllRequiredOC  ");
        if (this.getMmDrftPo().getCurrentRow() != null) {
            ViewObjectImpl ocView = this.getMmDrftPoOc();
            String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
            String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
            Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
            this.getOcImpView().setNamedWhereClauseParam("CldIdBind", cld_id);
            this.getOcImpView().setNamedWhereClauseParam("SlocIdBind", slocId);
            this.getOcImpView().setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
            this.getOcImpView().setNamedWhereClauseParam("DocIdBind", 18504);
            this.getOcImpView().setNamedWhereClauseParam("DocTypeIdBind", 741);
            this.getOcImpView().executeQuery();
            String chk = "Y";
            Integer docId = 18504;
            Integer docTypeId = 741;
            RowQualifier rq = new RowQualifier(this.getOcImpView());
            rq.setWhereClause("Reqd ='" + chk + "' and DocId =" + docId + " and DocTypeId =" + docTypeId + " ");
            Row[] rr = this.getOcImpView().getFilteredRows(rq);
            _log.info(rr.length + " row lenth  " + rq.getExprStr());
            if (rr.length > 0) {
                for (Row r : rr) {
                    RowQualifier rqOc = new RowQualifier(ocView);
                    rqOc.setWhereClause("OrgId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") +
                                        "' and SlocId =" + this.getMmDrftPo().getCurrentRow().getAttribute("SlocId") +
                                        " and CldId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("CldId") +
                                        "' and DocId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("DocId") +
                                        "' and OcId ='" + r.getAttribute("OcId") + "' ");
                    Row[] rrOcChk = ocView.getFilteredRows(rqOc);
                    _log.info(rrOcChk.length + "  oc dupli  " + rqOc.getExprStr());
                    if (rrOcChk.length == 0) {
                        _log.info(" record created.....");
                        Row rrOc = this.getMmDrftPoOc().createRow();
                        rrOc.setAttribute("OcId", r.getAttribute("OcId"));
                        rrOc.setAttribute("CoaId", r.getAttribute("CoaId") == null ? 0 : r.getAttribute("CoaId"));
                        rrOc.setAttribute("OcDesc", r.getAttribute("OcCat"));
                        rrOc.setAttribute("CurrIdSpOc", this.getMmDrftPo().getCurrentRow().getAttribute("TransCurrIdBs"));
                        rrOc.setAttribute("CurrConvFctrOc",
                                          1);
                        this.getMmDrftPoOc().insertRow(rrOc);
                    } else {
                        _log.info(" record already exist.....");
                    }

                }
            }

        }
    }

    public Integer checkAllOcApply() {
        if (this.getMmDrftPo().getCurrentRow() != null) {
            ViewObjectImpl ocView = this.getMmDrftPoOc();
            String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
            String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
            Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
            this.getOcImpView().setNamedWhereClauseParam("CldIdBind", cld_id);
            this.getOcImpView().setNamedWhereClauseParam("SlocIdBind", slocId);
            this.getOcImpView().setNamedWhereClauseParam("HoOrgIdBind", hoOrg_id);
            this.getOcImpView().setNamedWhereClauseParam("DocIdBind", 18504);
            this.getOcImpView().setNamedWhereClauseParam("DocTypeIdBind", 741);
            this.getOcImpView().executeQuery();
            _log.info("row count " + this.getOcImpView().getRowCount());
            String chk = "Y";
            Integer docId = 18504;
            Integer docTypeId = 741;
            RowQualifier rq = new RowQualifier(this.getOcImpView());
            rq.setWhereClause("Reqd ='" + chk + "' and DocId =" + docId + " and DocTypeId =" + docTypeId + " ");
            Row[] rr = this.getOcImpView().getFilteredRows(rq);
            _log.info(rr.length + " row lenth  " + rq.getExprStr());
            if (rr.length > 0) {
                for (Row r : rr) {
                    RowQualifier rqOc = new RowQualifier(this.getMmDrftPoOc());
                    rqOc.setWhereClause("OrgId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") +
                                        "' and SlocId =" + this.getMmDrftPo().getCurrentRow().getAttribute("SlocId") +
                                        " and CldId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("CldId") +
                                        "' and DocId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("DocId") +
                                        "' and OcId ='" + r.getAttribute("OcId") + "' ");
                    Row[] rrRow = this.getMmDrftPoOc().getFilteredRows(rqOc);
                    _log.info(rrRow.length + "    rrRow   " + rqOc.getExprStr());
                    if (rrRow.length == 0) {
                        return 1;
                    }
                }
            }
        }
        return 0;
    }

    public Integer chkAllQcAmtEnter() {
        if (this.getMmDrftPo().getCurrentRow() != null) {
            RowQualifier rqOc = new RowQualifier(this.getMmDrftPoOc());
            rqOc.setWhereClause("OrgId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") +
                                "' and SlocId =" + this.getMmDrftPo().getCurrentRow().getAttribute("SlocId") +
                                " and CldId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("CldId") +
                                "' and DocId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("DocId") + "' ");
            Row[] rr = this.getMmDrftPoOc().getFilteredRows(rqOc);
            _log.info(rr.length + "  row for x  " + rqOc.getExprStr());
            if (rr.length > 0) {
                for (Row r : rr) {
                    if (r.getAttribute("OcAmtSp") == null || zero.compareTo((Number) r.getAttribute("OcAmtSp")) == 0) {
                        _log.info("some Oc amount zero");
                        return 1;
                    }
                }

            } else {
                return 0;
            }
        }
        return 0;
    }

    public void changeOcCurrncy(String curr) {
        if (curr != null) {
            if (this.getMmDrftPoOc().getCurrentRow() != null &&
                ((Number) this.getMmDrftPoOc().getCurrentRow().getAttribute("OcAmtSpOc")).compareTo(zero) == 1) {
                Number ocFactor = new Number(1);
                Integer currOcId = 73;
                Integer currIdBs =
                    Integer.parseInt(this.getMmDrftPo().getCurrentRow().getAttribute("TransCurrIdBs").toString());
                Number currSpFactr = (Number) this.getMmDrftPo().getCurrentRow().getAttribute("CurrConvFctr");
                _log.info(currSpFactr + "curr in " + curr);
                Row[] rr = this.getLovCurrId().getFilteredRows("CurrDesc", curr);
                if (rr.length > 0 && rr[0].getAttribute("CurrId") != null) {
                    currOcId = Integer.parseInt(rr[0].getAttribute("CurrId").toString());
                }
                if (currIdBs != null && currOcId != null) {
                    RowQualifier rq = new RowQualifier(this.getLovCurrency());
                    rq.setWhereClause("HoOrgId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("TransHoOrgId") +
                                      "' and OrgId = '" + this.getMmDrftPo().getCurrentRow().getAttribute("OrgId") +
                                      "' and CldId ='" + this.getMmDrftPo().getCurrentRow().getAttribute("CldId") +
                                      "' and CcCurrId =" + currIdBs + " and CcCurrIdTxn =" + currOcId + " ");

                    Row[] rrC = this.getLovCurrency().getFilteredRows(rq);

                    _log.info(rrC.length + "  currency row " + rq.getExprStr());
                    if (rrC.length > 0 && rrC[0].getAttribute("CcBuy") != null) {
                        ocFactor = (Number) ((Number) rrC[0].getAttribute("CcBuy")).round(getGlblRoundCurrRateDigit());
                    }
                    _log.info(ocFactor + "   currSpFactr  " + currSpFactr);
                    if (ocFactor.compareTo(0) == 1 && currSpFactr.compareTo(zero) == 1) {

                        Number ocAmt = (Number) this.getMmDrftPoOc().getCurrentRow().getAttribute("OcAmtSpOc");
                        _log.info((ocAmt.multiply(ocFactor)).divide(currSpFactr) + "  ocAmt " + ocAmt +
                                  " ocAmt.multiply(ocFactor)   " + ocAmt.multiply(ocFactor));
                        this.getMmDrftPoOc().getCurrentRow().setAttribute("OcAmtBs",
                                                                          ocAmt.multiply(ocFactor).round(getGlblRoundAmtDigit()));
                        this.getMmDrftPoOc().getCurrentRow().setAttribute("OcAmtSp",
                                                                          ((ocAmt.multiply(ocFactor)).divide(currSpFactr)).round(getGlblRoundAmtDigit()));

                        //this.getMmDrftPoOc().getCurrentRow().setoca

                        _log.info("arg023  " + this.getMmDrftPoOc().getCurrentRow().getAttribute("OcAmtBs"));
                        _log.info("arg0234  " + this.getMmDrftPoOc().getCurrentRow().getAttribute("OcAmtSp"));
                    }
                }

            }
        }

    }

    public Integer checkLcDetails() {
        Row drftvo = this.getMmDrftPo().getCurrentRow();
        if (drftvo != null) {
            if (drftvo.getAttribute("LcId") == null) {
                return 1;
            } else {
                return 0;
            }

        } else {
            return 0;
        }
    }

    public String lcInsertion() {
        Row drftvo = this.getMmDrftPo().getCurrentRow();

        if (drftvo != null) {
            String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
            String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
            Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
            //Integer userId = Integer.parseInt(drftpoRw.getAttribute("UsrIdCreate").toString());
            String lcId = drftvo.getAttribute("LcId").toString();
            String srcDocId = drftvo.getAttribute("DocId").toString();
            String poType = drftvo.getAttribute("PoType").toString();
            Number balAmt = (Number) drftvo.getAttribute("LcBalAmt");
            Integer FyId = Integer.parseInt(drftvo.getAttribute("FyId").toString());
            _log.info("current auth po no is " + drftvo.getAttribute("AuthPoNo"));
            if (drftvo.getAttribute("AuthPoNo") != null) {
                BigDecimal retval =
                    (BigDecimal) (callStoredFunction(NUMBER, "app.fn_ins_lc_txn(?,?,?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                                     cld_id, slocId, hoOrg_id, orgId, lcId, srcDocId, poType,
                                                     drftvo.getAttribute("DocDt"), balAmt,
                                                     drftvo.getAttribute("UsrIdCreate"), FyId,
                                                     drftvo.getAttribute("AuthPoNo")
                }));

                _log.info("return value from lc " + retval);
            }
        }
        return null;
    }

    /**
     * Container's getter for LovLcId1.
     * @return LovLcId1
     */
    public ViewObjectImpl getLovLcId() {
        return (ViewObjectImpl) findViewObject("LovLcId");
    }

    /**
     * Container's getter for LovOcNm1.
     * @return LovOcNm1
     */
    public ViewObjectImpl getLovOcNm() {
        return (ViewObjectImpl) findViewObject("LovOcNm");
    }

    /**
     * Container's getter for LovFlexiFlds1.
     * @return LovFlexiFlds1
     */
    public ViewObjectImpl getLovFlexiFlds1() {
        return (ViewObjectImpl) findViewObject("LovFlexiFlds1");
    }

    /**
     * Container's getter for MmDrftPoFlx1.
     * @return MmDrftPoFlx1
     */
    public MmDrftPoFlxVOImpl getMmDrftPoFlx1() {
        return (MmDrftPoFlxVOImpl) findViewObject("MmDrftPoFlx1");
    }

    /**
     * Container's getter for PoToFlxVL1.
     * @return PoToFlxVL1
     */
    public ViewLinkImpl getPoToFlxVL1() {
        return (ViewLinkImpl) findViewLink("PoToFlxVL1");
    }


    // To add Flexi fields

    public String getFlexiFieldFilter() {
        String CldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}").toString();
        Integer poType = 171;
        Object potyp = this.getMmDrftPo().getCurrentRow().getAttribute("PoType");
        if (potyp != null) {
            poType = (Integer) potyp;
        }

        ViewObjectImpl itmFlex = this.getMmDrftPoFlx1();
        ViewObjectImpl flex = this.getLovFlxFielsView();
        flex.setNamedWhereClauseParam("bindCldId", CldId);
        flex.setNamedWhereClauseParam("bindDocId", 18504);
        flex.setNamedWhereClauseParam("bindDocTypeId", poType);
        flex.executeQuery();
        Integer docIdVal = 18504;
        Integer count = flex.getRowCount();
        System.out.println(poType + "no of field ::" + count);
        System.out.println(poType + "current row is " + this.getMmDrftPoFlx1().getCurrentRow());
        //  RowSetIterator rr = flex.createRowSetIterator(null);
        //Row[] rr = flex.getFilteredRows("DocId", new Integer(18504));
        RowQualifier rq = new RowQualifier(flex);
        rq.setWhereClause("DocId = " + docIdVal + " and DocTypeId =" + poType + " ");
        Row rr[] = flex.getFilteredRows(rq);
        // _log.info(" rr lenth   "+rr.length);
        _log.info(rq.getExprStr() + " rr lenth   " + rr.length);


        if (rr.length > 0) {
            for (Row r : rr) {
                System.out.println("total no. of rows found " + r.getAttribute("FldId"));
                Row r1 = itmFlex.createRow();
                //System.out.println("inserted row is "+r1);
                r1.setAttribute("FldId", r.getAttribute("FldId"));
                System.out.println("inserted row is " + r1);
                System.out.println("Label vaues are " + ((MmDrftPoFlxVORowImpl) r1).getLovFlexiFldsVO1().getRowCount());
                itmFlex.insertRow(r1);
            }
        }
        itmFlex.executeQuery();


        System.out.println("count111::" + itmFlex.getRowCount());
        return null;
    }

    public String validateFlexi() {
        ViewObject vo = this.getMmDrftPoFlx1();

        RowSetIterator iter = vo.createRowSetIterator(null);

        System.out.println("Row count is " + iter.getRowCount());

        while (iter.hasNext()) {
            MmDrftPoFlxVORowImpl row = (MmDrftPoFlxVORowImpl) iter.next();

            if (row.getTransFldReq().equalsIgnoreCase("Y") &&
                (row.getFldVal() == null || row.getFldVal().toString().trim().length() == 0)) {
                Row[] r = row.getLovFlexiFldsVO1().getFilteredRows("FldId", row.getFldId());
                System.out.println("Row name  is " + r[0].getAttribute("FldNm").toString());
                return r[0].getAttribute("FldNm").toString();
            }

        }
        return null;
    }

    /**
     * Container's getter for LovSupplierForAutoSuggest1.
     * @return LovSupplierForAutoSuggest1
     */
    public ViewObjectImpl getLovSupplierForAutoSuggest() {
        return (ViewObjectImpl) findViewObject("LovSupplierForAutoSuggest");
    }

    /**
     * Container's getter for MmQuotFlx1.
     * @return MmQuotFlx1
     */
    public MmQuotFlxVOImpl getMmQuotFlx1() {
        return (MmQuotFlxVOImpl) findViewObject("MmQuotFlx1");
    }

    /**
     * Added BY MS on 7-05-2015 to fill the flexi fields if po is from quotation.
     *
     * */

    public void fillFlexi() {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String cldId = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        Object val = this.getMmDrftPo().getCurrentRow().getAttribute("QuotDocId");
        String docId = val == null ? null : val.toString();
        MmDrftPoFlxVOImpl vo = this.getMmDrftPoFlx1();
        RowSetIterator iter = vo.createRowSetIterator(null);

        MmQuotFlxVOImpl quot = this.getMmQuotFlx1();
        quot.setBindCldId(cldId);
        quot.setBindOrgId(orgId);
        quot.setBindSlocId(slocId);
        quot.setBindDocId(docId);
        quot.executeQuery();


        while (iter.hasNext()) {
            MmDrftPoFlxVORowImpl row = (MmDrftPoFlxVORowImpl) iter.next();
            if (docId != null) {
                Row[] rr = quot.getFilteredRows("FldId", row.getFldId());
                if (rr.length > 0) {
                    row.setFldVal((String) rr[0].getAttribute("FldVal"));
                }
            } else {
                row.setFldVal(null);
            }
        }
    }

    /**
     * Container's getter for AppRmrks1.
     * @return AppRmrks1
     */
    public ViewObjectImpl getAppRmrks() {
        return (ViewObjectImpl) findViewObject("AppRmrks");
    }

    /**
     * Container's getter for AppWfAtchO1.
     * @return AppWfAtchO1
     */
    public ViewObjectImpl getAppWfAtchO() {
        return (ViewObjectImpl) findViewObject("AppWfAtchO");
    }

    public AppCostCenterServiceAMImpl getAppAM() {
        String appModuleName = "appCostCenterSevice.model.service.AppCostCenterServiceAM";
        String appModuleConfig = "AppCostCenterServiceAMLocal";
        return (AppCostCenterServiceAMImpl) Configuration.createRootApplicationModule(appModuleName, appModuleConfig);
    }


    public void releaseAppAM(AppCostCenterServiceAMImpl appCostCenter) {
        Configuration.releaseRootApplicationModule((ApplicationModule) appCostCenter, true);
    }

    @Override
    protected void finalize() throws Throwable {

        releaseAppAM(getAppAM());

        super.finalize();
    }

    /**
     * Method which will let us know whether cost center is applicable for this current document or not
     */
    public Boolean chkCcApplicableOrNot() {
        Boolean val = false;
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        ViewObjectImpl appCcDocVO1 = this.getAppCcDoc1();
        appCcDocVO1.setNamedWhereClauseParam("BindCldId", cld_id);
        appCcDocVO1.setNamedWhereClauseParam("BindSlocId", slocId);
        appCcDocVO1.setNamedWhereClauseParam("BindHoOrgId", hoOrg_id);
        appCcDocVO1.setNamedWhereClauseParam("BindOrgId", orgId);
        appCcDocVO1.setNamedWhereClauseParam("BindDocId", 18504);
        appCcDocVO1.executeQuery();

        Row[] allRowsInRange = appCcDocVO1.getAllRowsInRange();
        if (allRowsInRange.length > 0) {
            val = true;
        }

        return val;
    }

    /**
     * Method which will be called when user click on generate Cost Ceneter based on header wise
     */
    public void generateCostCenterHeaderWise() {
        if (chkCcApplicableOrNot()) {
            AppCostCenterServiceAMImpl amCC = getAppAM();
            /*
            * @param cldId
            * @param slocId
            * @param hoOrgId
            * @param orgId
            * @param tempId
            * @param tempSrc
            * @param docId
            * @param usrId
            * @param tempCcId
            * @param amount
            * @param pCcLevel1
            * @param pCcLevel2
            * @param pCcLevel3
            * @param pCcLevel4
            * @param pCcLevel5
            */
            MmDrftPoVOImpl impl = this.getMmDrftPo();
            Row currentRow = impl.getCurrentRow();

            if (currentRow != null) {
                declareGlblValuesForCC();
                String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
                String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
                String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
                Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
                Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
                amCC.generateCostCenterApp(cld_id, slocId, hoOrg_id, orgId, currentRow.getAttribute("DocId").toString(),
                                           "H", 18504, usrId, currentRow.getAttribute("DocId").toString(),
                                           new Number(0), (String) resolvElO("#{pageFlowScope.P_CC_LEVEL1}"),
                                           (String) resolvElO("#{pageFlowScope.P_CC_LEVEL2}"),
                                           (String) resolvElO("#{pageFlowScope.P_CC_LEVEL3}"),
                                           (String) resolvElO("#{pageFlowScope.P_CC_LEVEL4}"),
                                           (String) resolvElO("#{pageFlowScope.P_CC_LEVEL5}"));

            }
        }
    }


    /**
     * Method which will set Global Parameter Values and will be called before opening AppCostCenterServicesTF
     */
    public void declareGlblValuesForCC() {
        ViewObjectImpl appCcVwVO1 = this.getAppCcVw1();
        appCcVwVO1.setRangeSize(-1);
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
        appCcVwVO1.setNamedWhereClauseParam("BindCldId", cld_id);
        appCcVwVO1.setNamedWhereClauseParam("BindSlocId", slocId);
        appCcVwVO1.setNamedWhereClauseParam("BindHoOrgId", hoOrg_id);
        appCcVwVO1.setNamedWhereClauseParam("BindOrgId", orgId);
        appCcVwVO1.setNamedWhereClauseParam("BindDocId", 18504);

        Row currentRow = this.getMmDrftPoItm().getCurrentRow();
        if (currentRow != null) {
            for (int i = 1; i <= 5; i++) {
                appCcVwVO1.setNamedWhereClauseParam("BindCcPos", i);
                appCcVwVO1.executeQuery();

                Row[] allRowsInRange = appCcVwVO1.getAllRowsInRange();
                if (allRowsInRange.length > 0) {
                    String columnName = null;
                    for (Row r : allRowsInRange) {
                        AttributeDef[] attributeDef = this.getMmDrftPoItm().getAttributeDefs();

                        for (int j = 0; j < attributeDef.length; j++) {
                            /*  System.out.println("j value is " + attributeDef[j].getColumnName());
                                System.out.println("------------ null value is " + r.getAttribute("DbobColNm"));
                                System.out.println("attributeDef[j].getColumnName().equalsIgnoreCase(r.getAttribute(\"DbobColNm\").toString()) " +
                                                   attributeDef[j].getColumnName().equals(r.getAttribute("DbobColNm")));
                                */
                            if (attributeDef[j].getColumnName() != null &&
                                attributeDef[j].getColumnName().equals(r.getAttribute("DbobColNm"))) {
                                columnName = attributeDef[j].getName();
                            }
                        }
                        System.out.println("Column Name is " + columnName);

                        if (columnName != null) {

                            System.out.println("i is " + i + " Cost center Value is " +
                                               currentRow.getAttribute(columnName));


                            RequestContext.getCurrentInstance().getPageFlowScope().put("P_CC_LEVEL" + i,
                                                                                       currentRow.getAttribute(columnName));
                        }
                    }
                } else {
                    System.out.println("i is" + i + " cost center value is null");

                    RequestContext.getCurrentInstance().getPageFlowScope().put("P_CC_LEVEL" + i, null);

                }
            }
        }
    }


    /**
     * Container's getter for AppCcDoc1.
     * @return AppCcDoc1
     */
    public ViewObjectImpl getAppCcDoc1() {
        return (ViewObjectImpl) findViewObject("AppCcDoc1");
    }


    /**
     * Container's getter for AppCcVw1.
     * @return AppCcVw1
     */
    public ViewObjectImpl getAppCcVw1() {
        return (ViewObjectImpl) findViewObject("AppCcVw1");
    }

    /**
     * Method which will call cost center bean
     */
    public void deleteCostCenterItem() {
        if (chkCcApplicableOrNot()) {
            System.out.println("Inside delete method");
            String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
            String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
            String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
            Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
            Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));
            ViewObjectImpl impl = this.getMmDrftPoItm();
            Row currentRow = impl.getCurrentRow();
            if (currentRow != null && currentRow.getAttribute("CcId") != null) {
                AppCostCenterServiceAMImpl amCC = getAppAM();
                System.out.println("Inside Am after cresting object");
                if (amCC != null) {
                    System.out.println("------------------ Not null");
                    amCC.deleteCCLines(cld_id, slocId, hoOrg_id, orgId, currentRow.getAttribute("DocId").toString(),
                                       "L", 18505, usrId, currentRow.getAttribute("CcId").toString(), new Number(0),
                                       (String) resolvElO("#{pageFlowScope.P_CC_LEVEL1}"),
                                       (String) resolvElO("#{pageFlowScope.P_CC_LEVEL2}"),
                                       (String) resolvElO("#{pageFlowScope.P_CC_LEVEL3}"),
                                       (String) resolvElO("#{pageFlowScope.P_CC_LEVEL4}"),
                                       (String) resolvElO("#{pageFlowScope.P_CC_LEVEL5}"));

                }
            }
            System.out.println("After calling delete method");
        }
    }

    /**
     * Method which will update amount present in cost center table
     */
    public void updateCostCenterAmt() {
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));

        if (chkCcApplicableOrNot()) {
            System.out.println("Inside cost ceneter update amount method");
            ViewObjectImpl impl = this.getMmDrftPoItm();
            Row currentRow = impl.getCurrentRow();
            if (currentRow != null && currentRow.getAttribute("CcId") != null &&
                currentRow.getAttribute("TransItmAmtSpTax") != null) {
                AppCostCenterServiceAMImpl amCC = getAppAM();
                System.out.println("Inside Am after cresting object");
                if (amCC != null) {

                    declareGlblValuesForCC();

                    System.out.println("------------------ Not null");
                    Boolean amount =
                        amCC.updateCCAmount(cld_id, slocId, hoOrg_id, orgId,
                                            currentRow.getAttribute("DocId").toString(), "L", 18504, usrId,
                                            currentRow.getAttribute("CcId").toString(),
                                            (Number) currentRow.getAttribute("TransItmAmtSpTax"),
                                            (String) resolvElO("#{pageFlowScope.P_CC_LEVEL1}"),
                                            (String) resolvElO("#{pageFlowScope.P_CC_LEVEL2}"),
                                            (String) resolvElO("#{pageFlowScope.P_CC_LEVEL3}"),
                                            (String) resolvElO("#{pageFlowScope.P_CC_LEVEL4}"),
                                            (String) resolvElO("#{pageFlowScope.P_CC_LEVEL5}"));
                    if (!amount) {
                        StringBuilder saveMsg = new StringBuilder("<html><body><p><b>Update Cost Center" + "</b></p>");
                        saveMsg.append("Please Update Cost Center Values.</body></html>");
                        FacesMessage msg = new FacesMessage(saveMsg.toString());
                        msg.setSeverity(FacesMessage.SEVERITY_INFO);
                        FacesContext.getCurrentInstance().addMessage(null, msg);
                    }
                }
            }
            System.out.println("After calling Update method");
        }
    }

    public Integer addPaymentSchlForCpo() {

        ViewObject pmtVo = this.getMmDrftPoPmtSchdl();
        ViewObjectImpl pmtVoN = this.getMmDrftPoPmtSchdl();


        ViewObject mmPo = this.getMmDrftPo();
        Row currPo = mmPo.getCurrentRow();
        RowQualifier rq = new RowQualifier(pmtVoN);
        rq.setWhereClause("CldId ='" + currPo.getAttribute("CldId") + "' and SlocId =" + currPo.getAttribute("SlocId") +
                          " and OrgId ='" + currPo.getAttribute("OrgId") + "' and DocId ='" +
                          currPo.getAttribute("DocId") + "'");
        Row[] rr = pmtVoN.getFilteredRows(rq);
        _log.info(rr.length + "   " + rq.getExprStr());
        if (rr.length > 0) {
            for (Row r : rr) {
                _log.info("remove row ");
                r.remove();
            }
        }

        _log.info(" add new Row ");
        Number poCost = (Number) currPo.getAttribute("TransTotalPoCostSp");
        Number currFctr = (Number) ((Number) currPo.getAttribute("CurrConvFctr")).round(getGlblRoundCurrRateDigit());
        Row pmtCurr = pmtVo.createRow();
        pmtCurr.setAttribute("PayDt", currPo.getAttribute("PoDt"));
        pmtCurr.setAttribute("DocId", currPo.getAttribute("DocId"));
        pmtCurr.setAttribute("EntityId", new Integer(1));
        pmtCurr.setAttribute("OrgId", currPo.getAttribute("OrgId"));
        pmtCurr.setAttribute("SlocId", currPo.getAttribute("SlocId"));
        pmtCurr.setAttribute("PayAmt", poCost);
        pmtCurr.setAttribute("TotAmt", poCost);
        pmtCurr.setAttribute("PmtAmtType", "A");
        pmtCurr.setAttribute("PmtAmtVal", poCost);
        pmtCurr.setAttribute("TotAmtBs", poCost.multiply(currFctr).round(getGlblRoundAmtDigit()));
        pmtCurr.setAttribute("PayAmtBs", poCost.multiply(currFctr).round(getGlblRoundAmtDigit()));
        pmtCurr.setAttribute("UsrIdCreate", currPo.getAttribute("UsrIdCreate"));
        pmtCurr.setAttribute("AdvFlg", "N");
        pmtCurr.setAttribute("PayMode", 161);
        return 1;
    }

    /**
     * Container's getter for LovCoaNmForView1.
     * @return LovCoaNmForView1
     */
    public ViewObjectImpl getLovCoaNmForView() {
        return (ViewObjectImpl) findViewObject("LovCoaNmForView");
    }

    /**
     * Container's getter for LovItmForAutoSuggestCpoVoVO1.
     * @return LovItmForAutoSuggestCpoVoVO1
     */
    public ViewObjectImpl getLovItmForAutoSuggestCpoVoVO() {
        return (ViewObjectImpl) findViewObject("LovItmForAutoSuggestCpoVoVO");
    }

    public Integer addDlvSchAuto() {
        //        FUNCTION MM_AUTO_GEN_DLV_SCHDL_FRM_PO
        //                                                (
        //                                                P_CLD_ID VARCHAR,
        //                                                P_SLOC_ID NUMBER,
        //                                                P_ORG_ID VARCHAR,
        //                                                P_DOC_ID VARCHAR,
        //                                                P_DLV_DT DATE,
        //                                                P_WH_ID_DLV VARCHAR
        //                                                )

        ViewObjectImpl vo = this.getMmDrftPo();
        Row rr = vo.getCurrentRow();
        if (rr != null) {
            try {
                Integer ret =
                    Integer.parseInt(callStoredFunction(NUMBER, "MM.MM_AUTO_GEN_DLV_SCHDL_FRM_PO(?,?,?,?,?,?)", new Object[] {
                                                        rr.getAttribute("CldId"), rr.getAttribute("SlocId"),
                                                        rr.getAttribute("OrgId"), rr.getAttribute("DocId"),
                                                        rr.getAttribute("DlvDt"), rr.getAttribute("WhIdDlv")
                }).toString());

                if (ret.compareTo(new Integer(1)) == 0) {
                    this.getMmDrftPoDlvSchdl().executeQuery();
                    this.getMmDrftPoDlvSchdl1().executeQuery();
                    return 1;
                } else {
                    return 0;
                }

            } catch (Exception e) {
                e.printStackTrace();
                return 0;
            }

        } else {
            return 0;
        }


    }

    public String chkPoCancelOrNo() {
        ViewObjectImpl vo = this.getMmDrftPo();
        Row rr = vo.getCurrentRow();
        if (rr != null) {
            String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
            try {

                Object ret = (callStoredFunction(Types.VARCHAR, "FIN.fn_chk_ir_adv_row(?,?,?,?,?,?)", new Object[] {
                                                 rr.getAttribute("CldId"), rr.getAttribute("SlocId"), hoOrg_id,
                                                 rr.getAttribute("OrgId"), 18504, rr.getAttribute("DocId")




                }));
                System.out.println("return chkPoCancelOrNo " + ret);
                if (ret != null) {
                    return ret.toString();
                } else {
                    return "N";
                }


            } catch (Exception e) {
                e.printStackTrace();
                return "N";
            }
        } else {
            return "N";
        }
    }


    public Integer insPoItemFromPR() {
        //        FUNCTION MM_INS_PO_FRM_PR
        //                                                    (
        //                                                      P_CLD_ID VARCHAR2,
        //                                                      P_SLOC_ID NUMBER,
        //                                                      P_ORG_ID VARCHAR2,
        //                                                      P_DOC_ID VARCHAR2,
        //                                                      P_PR_DOC_ID VARCHAR2,
        //                                                      P_EO_ID NUMBER,
        //                                                      P_CURR_FACT NUMBER,
        //                                                      P_SUPP_CURR_ID NUMBER,
        //                                                      P_USR_ID NUMBER
        //                                                        P_PO_TYPE NUMBER
        //                                                    )

        ViewObjectImpl vo = this.getMmDrftPo();
        Row rr = vo.getCurrentRow();
        if (rr != null) {
            Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
            Object ob = callStoredFunction(Types.INTEGER, "MM.MM_INS_PO_FRM_PR(?,?,?,?,?,?,?,?,?,?)", new Object[] {
                                           rr.getAttribute("CldId"), rr.getAttribute("SlocId"),
                                           rr.getAttribute("OrgId"), rr.getAttribute("DocId"),
                                           rr.getAttribute("PrDocId"), rr.getAttribute("EoId"),
                                           rr.getAttribute("CurrConvFctr"), rr.getAttribute("CurrIdSp"), usrId,
                                           rr.getAttribute("PoType")
            });
            _log.info(ob + " ++++ob   " + rr.getAttribute("PrDocId"));
            if (ob != null) {
                Integer ret = Integer.parseInt(ob.toString());
                if (ret.compareTo(new Integer(1)) == 0) {
                    this.getMmDrftPoItm().executeQuery();
                    this.getMmDrftPoItm1().executeQuery();
                    this.getMmDrftPoFlx1().executeQuery();
                    return 1;
                } else {
                    return 0;
                }
            } else {
                return 0;
            }
        } else {
            return 0;
        }
    }

    /**
     * Container's getter for LovPrNoView1.
     * @return LovPrNoView1
     */
    public ViewObjectImpl getLovPrNoView() {
        return (ViewObjectImpl) findViewObject("LovPrNoView");
    }

    /**
     * Container's getter for LovFlxFielsView1.
     * @return LovFlxFielsView1
     */
    public ViewObjectImpl getLovFlxFielsView() {
        return (ViewObjectImpl) findViewObject("LovFlxFielsView");
    }

    /**
     * Container's getter for LovCostCenterFinalize1.
     * @return LovCostCenterFinalize1
     */
    public ViewObjectImpl getLovCostCenterFinalize() {
        return (ViewObjectImpl) findViewObject("LovCostCenterFinalize");
    }

    public String chkCostCenterFinelize() {
        String ret = "N";
        String hoOrg_id = resolvEl("#{pageFlowScope.GLBL_HO_ORG_ID}");
        String cld_id = resolvEl("#{pageFlowScope.GLBL_APP_CLD_ID1}");
        String orgId = resolvEl("#{pageFlowScope.GLBL_APP_USR_ORG}");
        Integer slocId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_SERV_LOC1}"));

        this.getLovCostCenterFinalize().setNamedWhereClauseParam("BindCldId", cld_id);
        this.getLovCostCenterFinalize().setNamedWhereClauseParam("BindOrgId", orgId);
        this.getLovCostCenterFinalize().setNamedWhereClauseParam("BindHoOrgId", hoOrg_id);
        this.getLovCostCenterFinalize().setNamedWhereClauseParam("BindSlocId", slocId);
        this.getLovCostCenterFinalize().setNamedWhereClauseParam("BindDocId", 18504);
        this.getLovCostCenterFinalize().executeQuery();
        Row[] rr = this.getLovCostCenterFinalize().getFilteredRows("CcPrfDocId", 18504);
        if (rr.length > 0) {
            ret = "Y";
        }
        _log.info(rr.length + "  return value " + ret);
        return ret;
    }

    public Integer closePoItemQuantity() {

        //        FUNCTION MM_PO_ITM_UPDT_CLS(
        //                                                      P_CLD_ID VARCHAR2,
        //                                                      P_SLOC_ID NUMBER,
        //                                                      P_ORG_ID  VARCHAR2,
        //                                                      P_DOC_ID VARCHAR2,
        //                                                      P_ITM_ID VARCHAR2,
        //                                                      P_ITM_UOM VARCHAR2
        //                                                      )

        if (this.getMmDrftPoItm().getCurrentRow() != null) {
            Row rr = this.getMmDrftPoItm().getCurrentRow();
            try {
                this.getDBTransaction().postChanges();
                Object ob = callStoredFunction(Types.INTEGER, "MM.MM_PO_ITM_UPDT_CLS(?,?,?,?,?,?)", new Object[] {
                                               rr.getAttribute("CldId"), rr.getAttribute("SlocId"),
                                               rr.getAttribute("OrgId"), rr.getAttribute("DocId"),
                                               rr.getAttribute("ItmId"), rr.getAttribute("ItmUom"),
                });

                _log.info(" return " + ob);
                if (ob != null) {
                    if (((Integer) ob).compareTo(new Integer(1)) == 0) {
                        this.getMmDrftPoItm().executeQuery();
                        return 1;
                    }
                }
            } catch (Exception e) {
                e.printStackTrace();
                return 0;
            }
        }
        return 0;
    }

    public String isPoItmClose() {
        String ret = "N";

        //        FUNCTION WF_GET_USR_TOP_LVL
        //                                                    (
        //                                                    P_SLOCID NUMBER,
        //                                                    P_CLDID VARCHAR2,
        //                                                    P_ORGID VARCHAR2,
        //                                                    P_DOCID NUMBER,
        //                                                    P_DOC_TYPEID NUMBER,
        //                                                    P_USER_ID NUMBER
        //                                                    )

        if (this.getMmDrftPo() != null) {
            Integer usrId = Integer.parseInt(resolvEl("#{pageFlowScope.GLBL_APP_USR}"));
            Row rr = this.getMmDrftPo().getCurrentRow();
            Object ob2 = rr.getAttribute("PoStatus");
            Object ob3 = rr.getAttribute("PoMode");

            if (ob2 != null && ob3 != null) {
                _log.info(ob2+"   21----------"+ob3);
                if (((Integer) ob2).compareTo(new Integer(217)) == 0 &&
                    ((Integer) ob3).compareTo(new Integer(231)) == 0) {
                    _log.info("22----------");
                    try {
                        Object ob = callStoredFunction(Types.VARCHAR, "APP.WF_GET_USR_TOP_LVL(?,?,?,?,?,?)", new Object[] {
                                                        rr.getAttribute("SlocId"),rr.getAttribute("CldId"),
                                                       rr.getAttribute("OrgId"), 18504, rr.getAttribute("PoType"), usrId
                        });

                        _log.info(" return " + ob);
                        if (ob != null) {
                            if ("Y".equalsIgnoreCase(ob.toString())) {
                                _log.info("23----------");
                                if (this.getMmDrftPoItm().getCurrentRow().getAttribute("CloseFlg") != null &&
                                    "N".equalsIgnoreCase(this.getMmDrftPoItm().getCurrentRow().getAttribute("CloseFlg").toString())) {
                                    _log.info("24----------"+this.getMmDrftPoItm().getCurrentRow().getAttribute("ItmId"));
                                    ret = "Y";
                                }
                            }
                        }
                    } catch (Exception e) {
                        e.printStackTrace();
                        _log.info("25----------");
                        ret = "N";
                    }
                } else {
                    _log.info("26----------");
                    ret = "N";
                }
            } else {
                _log.info("27----------");
                ret = "N";
            }


        }
        
        _log.info(" 28 "+ret);
        return ret;
    }
    
    
    public String viewWFData(){
        if(this.getMmDrftPo().getCurrentRow()!=null){
           // WF_GET_DOC_FLOW(P_SLOC_ID NUMBER , P_ORG_ID VARCHAR2 , P_CLD_ID VARCHAR2 , P_DOC_ID NUMBER , P_TXN_DOC_ID VARCHAR2)
            try{
                _log.info("Doc Id "+ this.getMmDrftPo().getCurrentRow().getAttribute("DocId"));
                Object ob = callStoredFunction(Types.VARCHAR, "APP.WF_GET_DOC_FLOW(?,?,?,?,?)", new Object[] {
                                                this.getMmDrftPo().getCurrentRow().getAttribute("SlocId"),this.getMmDrftPo().getCurrentRow().getAttribute("OrgId"),
                                               this.getMmDrftPo().getCurrentRow().getAttribute("CldId"), 18504, this.getMmDrftPo().getCurrentRow().getAttribute("DocId")
                });
                _log.info("ob    "+ob);
                if(ob!=null){
                    return ob.toString();
                }else{
             return "Document Not In WF";                
                }
            }catch(Exception e){
                e.printStackTrace();
                return "Document Not In WF";
            }
            
           
            
        }else{
            return "Document Not In WF";
        }
    }

    /**
     * Container's getter for LovQuotDocId1.
     * @return LovQuotDocId1
     */
    public ViewObjectImpl getLovQuotDocId1() {
        return (ViewObjectImpl) findViewObject("LovQuotDocId1");
    }
    
    public String quotDocId(String quotNo){
        String docIdQuot =null;
        if(this.getMmDrftPo()!=null){
          
            ViewObjectImpl vo = this.getLovQuotDocId1();
            RowQualifier rq = new RowQualifier(vo);
            rq.setWhereClause("CldId='"+this.getMmDrftPo().getCurrentRow().getAttribute("CldId")+"' and SlocId ="+this.getMmDrftPo().getCurrentRow().getAttribute("SlocId")+" and OrgId ='"+this.getMmDrftPo().getCurrentRow().getAttribute("OrgId")+"' and QuotIdDisp = '"+quotNo+"' ");
            Row rr[] =vo.getFilteredRows(rq);
            if(rr.length>0 && rr[0].getAttribute("DocId")!=null){
                docIdQuot = rr[0].getAttribute("DocId").toString();
            }
        }
        _log.info(quotNo+" docIdQuot   "+docIdQuot);
        return docIdQuot;
    }

    /**
     * Container's getter for LovQuotNoDisp1.
     * @return LovQuotNoDisp1
     */
    public ViewObjectImpl getLovQuotNoDisp() {
        return (ViewObjectImpl) findViewObject("LovQuotNoDisp");
    }
}
